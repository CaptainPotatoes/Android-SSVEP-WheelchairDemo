//
// Academic License - for use in teaching, academic research, and meeting
// course requirements at degree granting institutions only.  Not for
// government, commercial, or other organizational use.
// File: classifySSVEP.cpp
//
// MATLAB Coder version            : 3.1
// C/C++ source code generated on  : 22-May-2017 11:55:35
//

// Include Files
#include "rt_nonfinite.h"
#include "classifySSVEP.h"

// Type Definitions
#ifndef struct_emxArray__common
#define struct_emxArray__common

struct emxArray__common
{
  void *data;
  int *size;
  int allocatedSize;
  int numDimensions;
  boolean_T canFreeData;
};

#endif                                 //struct_emxArray__common

#ifndef struct_emxArray_int32_T
#define struct_emxArray_int32_T

struct emxArray_int32_T
{
  int *data;
  int *size;
  int allocatedSize;
  int numDimensions;
  boolean_T canFreeData;
};

#endif                                 //struct_emxArray_int32_T

#ifndef struct_emxArray_real_T
#define struct_emxArray_real_T

struct emxArray_real_T
{
  double *data;
  int *size;
  int allocatedSize;
  int numDimensions;
  boolean_T canFreeData;
};

#endif                                 //struct_emxArray_real_T

// Variable Definitions
//omp_nest_lock_t emlrtNestLockGlobal;

// Function Declarations
static void b_sin(const double x[2000], double b_x[2000]);
static void c_sin(double x[2000]);
static void emxEnsureCapacity(emxArray__common *emxArray, int oldNumel, int
  elementSize);
static void emxFree_int32_T(emxArray_int32_T **pEmxArray);
static void emxFree_real_T(emxArray_real_T **pEmxArray);
static void emxInit_int32_T(emxArray_int32_T **pEmxArray, int numDimensions);
static void emxInit_int32_T1(emxArray_int32_T **pEmxArray, int numDimensions);
static void emxInit_real_T(emxArray_real_T **pEmxArray, int numDimensions);
static void emxInit_real_T1(emxArray_real_T **pEmxArray, int numDimensions);
static void fESSVEP2(const emxArray_real_T *X0, double P[56]);
static void filter(const emxArray_real_T *x, const double zi[6], emxArray_real_T
                   *y);
static void ssvepcfilt(emxArray_real_T *X, emxArray_real_T *Y);
static void welch_psd(const emxArray_real_T *signals, double fs, const double
                      window[2048], double CSM[1024], double frequencies[1024]);

// Function Definitions

//
// Arguments    : const double x[2000]
//                double b_x[2000]
// Return Type  : void
//
static void b_sin(const double x[2000], double b_x[2000])
{
  memcpy(&b_x[0], &x[0], 2000U * sizeof(double));
  c_sin(b_x);
}

//
// Arguments    : double x[2000]
// Return Type  : void
//
static void c_sin(double x[2000])
{
  int k;
  for (k = 0; k < 2000; k++) {
    x[k] = std::sin(x[k]);
  }
}

//
// Arguments    : emxArray__common *emxArray
//                int oldNumel
//                int elementSize
// Return Type  : void
//
static void emxEnsureCapacity(emxArray__common *emxArray, int oldNumel, int
  elementSize)
{
  int newNumel;
  int i;
  void *newData;
  newNumel = 1;
  for (i = 0; i < emxArray->numDimensions; i++) {
    newNumel *= emxArray->size[i];
  }

  if (newNumel > emxArray->allocatedSize) {
    i = emxArray->allocatedSize;
    if (i < 16) {
      i = 16;
    }

    while (i < newNumel) {
      if (i > 1073741823) {
        i = MAX_int32_T;
      } else {
        i <<= 1;
      }
    }

    newData = calloc((unsigned int)i, (unsigned int)elementSize);
    if (emxArray->data != NULL) {
      memcpy(newData, emxArray->data, (unsigned int)(elementSize * oldNumel));
      if (emxArray->canFreeData) {
        free(emxArray->data);
      }
    }

    emxArray->data = newData;
    emxArray->allocatedSize = i;
    emxArray->canFreeData = true;
  }
}

//
// Arguments    : emxArray_int32_T **pEmxArray
// Return Type  : void
//
static void emxFree_int32_T(emxArray_int32_T **pEmxArray)
{
  if (*pEmxArray != (emxArray_int32_T *)NULL) {
    if (((*pEmxArray)->data != (int *)NULL) && (*pEmxArray)->canFreeData) {
      free((void *)(*pEmxArray)->data);
    }

    free((void *)(*pEmxArray)->size);
    free((void *)*pEmxArray);
    *pEmxArray = (emxArray_int32_T *)NULL;
  }
}

//
// Arguments    : emxArray_real_T **pEmxArray
// Return Type  : void
//
static void emxFree_real_T(emxArray_real_T **pEmxArray)
{
  if (*pEmxArray != (emxArray_real_T *)NULL) {
    if (((*pEmxArray)->data != (double *)NULL) && (*pEmxArray)->canFreeData) {
      free((void *)(*pEmxArray)->data);
    }

    free((void *)(*pEmxArray)->size);
    free((void *)*pEmxArray);
    *pEmxArray = (emxArray_real_T *)NULL;
  }
}

//
// Arguments    : emxArray_int32_T **pEmxArray
//                int numDimensions
// Return Type  : void
//
static void emxInit_int32_T(emxArray_int32_T **pEmxArray, int numDimensions)
{
  emxArray_int32_T *emxArray;
  int i;
  *pEmxArray = (emxArray_int32_T *)malloc(sizeof(emxArray_int32_T));
  emxArray = *pEmxArray;
  emxArray->data = (int *)NULL;
  emxArray->numDimensions = numDimensions;
  emxArray->size = (int *)malloc((unsigned int)(sizeof(int) * numDimensions));
  emxArray->allocatedSize = 0;
  emxArray->canFreeData = true;
  for (i = 0; i < numDimensions; i++) {
    emxArray->size[i] = 0;
  }
}

//
// Arguments    : emxArray_int32_T **pEmxArray
//                int numDimensions
// Return Type  : void
//
static void emxInit_int32_T1(emxArray_int32_T **pEmxArray, int numDimensions)
{
  emxArray_int32_T *emxArray;
  int i;
  *pEmxArray = (emxArray_int32_T *)malloc(sizeof(emxArray_int32_T));
  emxArray = *pEmxArray;
  emxArray->data = (int *)NULL;
  emxArray->numDimensions = numDimensions;
  emxArray->size = (int *)malloc((unsigned int)(sizeof(int) * numDimensions));
  emxArray->allocatedSize = 0;
  emxArray->canFreeData = true;
  for (i = 0; i < numDimensions; i++) {
    emxArray->size[i] = 0;
  }
}

//
// Arguments    : emxArray_real_T **pEmxArray
//                int numDimensions
// Return Type  : void
//
static void emxInit_real_T(emxArray_real_T **pEmxArray, int numDimensions)
{
  emxArray_real_T *emxArray;
  int i;
  *pEmxArray = (emxArray_real_T *)malloc(sizeof(emxArray_real_T));
  emxArray = *pEmxArray;
  emxArray->data = (double *)NULL;
  emxArray->numDimensions = numDimensions;
  emxArray->size = (int *)malloc((unsigned int)(sizeof(int) * numDimensions));
  emxArray->allocatedSize = 0;
  emxArray->canFreeData = true;
  for (i = 0; i < numDimensions; i++) {
    emxArray->size[i] = 0;
  }
}

//
// Arguments    : emxArray_real_T **pEmxArray
//                int numDimensions
// Return Type  : void
//
static void emxInit_real_T1(emxArray_real_T **pEmxArray, int numDimensions)
{
  emxArray_real_T *emxArray;
  int i;
  *pEmxArray = (emxArray_real_T *)malloc(sizeof(emxArray_real_T));
  emxArray = *pEmxArray;
  emxArray->data = (double *)NULL;
  emxArray->numDimensions = numDimensions;
  emxArray->size = (int *)malloc((unsigned int)(sizeof(int) * numDimensions));
  emxArray->allocatedSize = 0;
  emxArray->canFreeData = true;
  for (i = 0; i < numDimensions; i++) {
    emxArray->size[i] = 0;
  }
}

//
// FESSVEP Feature Extraction for single (m x 1) SSVEP EEG Data Vector
//    X (m x 1) vectorize input:
//  Fix X size:
// Arguments    : const emxArray_real_T *X0
//                double P[56]
// Return Type  : void
//
static void fESSVEP2(const emxArray_real_T *X0, double P[56])
{
  emxArray_real_T *X;
  int ixstart;
  int jA2;
  emxArray_real_T *convconv;
  static double sigs[56000];
  int i;
  double wfreqs[1024];
  double Mconv[28];
  short Lconv[28];
  emxArray_real_T *r2;
  emxArray_real_T *b_convconv;
  int nA;
  int nC;
  double s;
  static const double dv3[28] = { 9.7, 9.7999999999999989, 9.8999999999999986,
    10.0, 10.100000000000001, 10.200000000000001, 10.3, 12.1, 12.2,
    12.299999999999999, 12.399999999999999, 12.5, 12.6, 12.7, 14.8, 14.9, 15.0,
    15.100000000000001, 15.200000000000001, 15.3, 15.4, 16.2, 16.3, 16.4, 16.5,
    16.6, 16.7, 16.8 };

  double b[2000];
  static const double b_b[2000] = { 0.0, 0.004, 0.008, 0.012, 0.016, 0.02, 0.024,
    0.028, 0.032, 0.036000000000000004, 0.04, 0.044, 0.048, 0.052000000000000005,
    0.056, 0.06, 0.064, 0.068, 0.072000000000000008, 0.076, 0.08, 0.084, 0.088,
    0.092, 0.096, 0.1, 0.10400000000000001, 0.108, 0.112, 0.116, 0.12, 0.124,
    0.128, 0.132, 0.136, 0.14, 0.14400000000000002, 0.148, 0.152, 0.156, 0.16,
    0.164, 0.168, 0.17200000000000001, 0.176, 0.18, 0.184, 0.188, 0.192, 0.196,
    0.2, 0.20400000000000001, 0.20800000000000002, 0.212, 0.216, 0.22, 0.224,
    0.228, 0.232, 0.23600000000000002, 0.24, 0.244, 0.248, 0.252, 0.256, 0.26,
    0.264, 0.268, 0.272, 0.276, 0.28, 0.28400000000000003, 0.28800000000000003,
    0.292, 0.296, 0.3, 0.304, 0.308, 0.312, 0.316, 0.32, 0.324, 0.328, 0.332,
    0.336, 0.34, 0.34400000000000003, 0.34800000000000003, 0.352, 0.356, 0.36,
    0.364, 0.368, 0.372, 0.376, 0.38, 0.384, 0.388, 0.392, 0.396, 0.4, 0.404,
    0.40800000000000003, 0.41200000000000003, 0.41600000000000004, 0.42, 0.424,
    0.428, 0.432, 0.436, 0.44, 0.444, 0.448, 0.452, 0.456, 0.46, 0.464, 0.468,
    0.47200000000000003, 0.47600000000000003, 0.48, 0.484, 0.488, 0.492, 0.496,
    0.5, 0.504, 0.508, 0.512, 0.516, 0.52, 0.524, 0.528, 0.532, 0.536, 0.54,
    0.544, 0.548, 0.552, 0.556, 0.56, 0.56400000000000006, 0.56800000000000006,
    0.57200000000000006, 0.57600000000000007, 0.58, 0.584, 0.588, 0.592, 0.596,
    0.6, 0.604, 0.608, 0.612, 0.616, 0.62, 0.624, 0.628, 0.632, 0.636, 0.64,
    0.644, 0.648, 0.652, 0.656, 0.66, 0.664, 0.668, 0.672, 0.676, 0.68, 0.684,
    0.68800000000000006, 0.69200000000000006, 0.69600000000000006,
    0.70000000000000007, 0.704, 0.708, 0.712, 0.716, 0.72, 0.724, 0.728, 0.732,
    0.736, 0.74, 0.744, 0.748, 0.752, 0.756, 0.76, 0.764, 0.768, 0.772, 0.776,
    0.78, 0.784, 0.788, 0.792, 0.796, 0.8, 0.804, 0.808, 0.812,
    0.81600000000000006, 0.82000000000000006, 0.82400000000000007,
    0.82800000000000007, 0.83200000000000007, 0.836, 0.84, 0.844, 0.848, 0.852,
    0.856, 0.86, 0.864, 0.868, 0.872, 0.876, 0.88, 0.884, 0.888, 0.892, 0.896,
    0.9, 0.904, 0.908, 0.912, 0.916, 0.92, 0.924, 0.928, 0.932, 0.936,
    0.94000000000000006, 0.94400000000000006, 0.94800000000000006,
    0.95200000000000007, 0.95600000000000007, 0.96, 0.964, 0.968, 0.972, 0.976,
    0.98, 0.984, 0.988, 0.992, 0.996, 1.0, 1.004, 1.008, 1.012, 1.016, 1.02,
    1.024, 1.028, 1.032, 1.036, 1.04, 1.044, 1.048, 1.052, 1.056, 1.06, 1.064,
    1.068, 1.072, 1.076, 1.08, 1.084, 1.088, 1.092, 1.096, 1.1, 1.104, 1.108,
    1.112, 1.116, 1.12, 1.124, 1.1280000000000001, 1.1320000000000001,
    1.1360000000000001, 1.1400000000000001, 1.1440000000000001,
    1.1480000000000001, 1.1520000000000001, 1.156, 1.16, 1.164, 1.168, 1.172,
    1.176, 1.18, 1.184, 1.188, 1.192, 1.196, 1.2, 1.204, 1.208, 1.212, 1.216,
    1.22, 1.224, 1.228, 1.232, 1.236, 1.24, 1.244, 1.248, 1.252, 1.256, 1.26,
    1.264, 1.268, 1.272, 1.276, 1.28, 1.284, 1.288, 1.292, 1.296, 1.3, 1.304,
    1.308, 1.312, 1.316, 1.32, 1.324, 1.328, 1.332, 1.336, 1.34, 1.344, 1.348,
    1.352, 1.356, 1.36, 1.364, 1.368, 1.372, 1.3760000000000001,
    1.3800000000000001, 1.3840000000000001, 1.3880000000000001,
    1.3920000000000001, 1.3960000000000001, 1.4000000000000001,
    1.4040000000000001, 1.408, 1.412, 1.416, 1.42, 1.424, 1.428, 1.432, 1.436,
    1.44, 1.444, 1.448, 1.452, 1.456, 1.46, 1.464, 1.468, 1.472, 1.476, 1.48,
    1.484, 1.488, 1.492, 1.496, 1.5, 1.504, 1.508, 1.512, 1.516, 1.52, 1.524,
    1.528, 1.532, 1.536, 1.54, 1.544, 1.548, 1.552, 1.556, 1.56, 1.564, 1.568,
    1.572, 1.576, 1.58, 1.584, 1.588, 1.592, 1.596, 1.6, 1.604, 1.608, 1.612,
    1.616, 1.62, 1.624, 1.6280000000000001, 1.6320000000000001,
    1.6360000000000001, 1.6400000000000001, 1.6440000000000001,
    1.6480000000000001, 1.6520000000000001, 1.6560000000000001,
    1.6600000000000001, 1.6640000000000001, 1.668, 1.672, 1.676, 1.68, 1.684,
    1.688, 1.692, 1.696, 1.7, 1.704, 1.708, 1.712, 1.716, 1.72, 1.724, 1.728,
    1.732, 1.736, 1.74, 1.744, 1.748, 1.752, 1.756, 1.76, 1.764, 1.768, 1.772,
    1.776, 1.78, 1.784, 1.788, 1.792, 1.796, 1.8, 1.804, 1.808, 1.812, 1.816,
    1.82, 1.824, 1.828, 1.832, 1.836, 1.84, 1.844, 1.848, 1.852, 1.856, 1.86,
    1.864, 1.868, 1.872, 1.8760000000000001, 1.8800000000000001,
    1.8840000000000001, 1.8880000000000001, 1.8920000000000001,
    1.8960000000000001, 1.9000000000000001, 1.9040000000000001,
    1.9080000000000001, 1.9120000000000001, 1.9160000000000001, 1.92, 1.924,
    1.928, 1.932, 1.936, 1.94, 1.944, 1.948, 1.952, 1.956, 1.96, 1.964, 1.968,
    1.972, 1.976, 1.98, 1.984, 1.988, 1.992, 1.996, 2.0, 2.004, 2.008, 2.012,
    2.016, 2.02, 2.024, 2.028, 2.032, 2.036, 2.04, 2.044, 2.048, 2.052, 2.056,
    2.06, 2.064, 2.068, 2.072, 2.076, 2.08, 2.084, 2.088, 2.092, 2.096, 2.1,
    2.104, 2.108, 2.112, 2.116, 2.12, 2.124, 2.128, 2.132, 2.136, 2.14, 2.144,
    2.148, 2.152, 2.156, 2.16, 2.164, 2.168, 2.172, 2.176, 2.18, 2.184, 2.188,
    2.192, 2.196, 2.2, 2.204, 2.208, 2.212, 2.216, 2.22, 2.224, 2.228, 2.232,
    2.236, 2.24, 2.244, 2.248, 2.2520000000000002, 2.2560000000000002,
    2.2600000000000002, 2.2640000000000002, 2.2680000000000002,
    2.2720000000000002, 2.2760000000000002, 2.2800000000000002,
    2.2840000000000003, 2.2880000000000003, 2.2920000000000003,
    2.2960000000000003, 2.3000000000000003, 2.3040000000000003, 2.308, 2.312,
    2.316, 2.32, 2.324, 2.328, 2.332, 2.336, 2.34, 2.344, 2.348, 2.352, 2.356,
    2.36, 2.364, 2.368, 2.372, 2.376, 2.38, 2.384, 2.388, 2.392, 2.396, 2.4,
    2.404, 2.408, 2.412, 2.416, 2.42, 2.424, 2.428, 2.432, 2.436, 2.44, 2.444,
    2.448, 2.452, 2.456, 2.46, 2.464, 2.468, 2.472, 2.476, 2.48, 2.484, 2.488,
    2.492, 2.496, 2.5, 2.504, 2.508, 2.512, 2.516, 2.52, 2.524, 2.528, 2.532,
    2.536, 2.54, 2.544, 2.548, 2.552, 2.556, 2.56, 2.564, 2.568, 2.572, 2.576,
    2.58, 2.584, 2.588, 2.592, 2.596, 2.6, 2.604, 2.608, 2.612, 2.616, 2.62,
    2.624, 2.628, 2.632, 2.636, 2.64, 2.644, 2.648, 2.652, 2.656, 2.66, 2.664,
    2.668, 2.672, 2.676, 2.68, 2.684, 2.688, 2.692, 2.696, 2.7, 2.704, 2.708,
    2.712, 2.716, 2.72, 2.724, 2.728, 2.732, 2.736, 2.74, 2.744, 2.748,
    2.7520000000000002, 2.7560000000000002, 2.7600000000000002,
    2.7640000000000002, 2.7680000000000002, 2.7720000000000002,
    2.7760000000000002, 2.7800000000000002, 2.7840000000000003,
    2.7880000000000003, 2.7920000000000003, 2.7960000000000003,
    2.8000000000000003, 2.8040000000000003, 2.8080000000000003,
    2.8120000000000003, 2.816, 2.82, 2.824, 2.828, 2.832, 2.836, 2.84, 2.844,
    2.848, 2.852, 2.856, 2.86, 2.864, 2.868, 2.872, 2.876, 2.88, 2.884, 2.888,
    2.892, 2.896, 2.9, 2.904, 2.908, 2.912, 2.916, 2.92, 2.924, 2.928, 2.932,
    2.936, 2.94, 2.944, 2.948, 2.952, 2.956, 2.96, 2.964, 2.968, 2.972, 2.976,
    2.98, 2.984, 2.988, 2.992, 2.996, 3.0, 3.004, 3.008, 3.012, 3.016, 3.02,
    3.024, 3.028, 3.032, 3.036, 3.04, 3.044, 3.048, 3.052, 3.056, 3.06, 3.064,
    3.068, 3.072, 3.076, 3.08, 3.084, 3.088, 3.092, 3.096, 3.1, 3.104, 3.108,
    3.112, 3.116, 3.12, 3.124, 3.128, 3.132, 3.136, 3.14, 3.144, 3.148, 3.152,
    3.156, 3.16, 3.164, 3.168, 3.172, 3.176, 3.18, 3.184, 3.188, 3.192, 3.196,
    3.2, 3.204, 3.208, 3.212, 3.216, 3.22, 3.224, 3.228, 3.232, 3.236, 3.24,
    3.244, 3.248, 3.2520000000000002, 3.2560000000000002, 3.2600000000000002,
    3.2640000000000002, 3.2680000000000002, 3.2720000000000002,
    3.2760000000000002, 3.2800000000000002, 3.2840000000000003,
    3.2880000000000003, 3.2920000000000003, 3.2960000000000003,
    3.3000000000000003, 3.3040000000000003, 3.3080000000000003,
    3.3120000000000003, 3.3160000000000003, 3.3200000000000003,
    3.3240000000000003, 3.3280000000000003, 3.332, 3.336, 3.34, 3.344, 3.348,
    3.352, 3.356, 3.36, 3.364, 3.368, 3.372, 3.376, 3.38, 3.384, 3.388, 3.392,
    3.396, 3.4, 3.404, 3.408, 3.412, 3.416, 3.42, 3.424, 3.428, 3.432, 3.436,
    3.44, 3.444, 3.448, 3.452, 3.456, 3.46, 3.464, 3.468, 3.472, 3.476, 3.48,
    3.484, 3.488, 3.492, 3.496, 3.5, 3.504, 3.508, 3.512, 3.516, 3.52, 3.524,
    3.528, 3.532, 3.536, 3.54, 3.544, 3.548, 3.552, 3.556, 3.56, 3.564, 3.568,
    3.572, 3.576, 3.58, 3.584, 3.588, 3.592, 3.596, 3.6, 3.604, 3.608, 3.612,
    3.616, 3.62, 3.624, 3.628, 3.632, 3.636, 3.64, 3.644, 3.648, 3.652, 3.656,
    3.66, 3.664, 3.668, 3.672, 3.676, 3.68, 3.684, 3.688, 3.692, 3.696, 3.7,
    3.704, 3.708, 3.712, 3.716, 3.72, 3.724, 3.728, 3.732, 3.736, 3.74, 3.744,
    3.748, 3.7520000000000002, 3.7560000000000002, 3.7600000000000002,
    3.7640000000000002, 3.7680000000000002, 3.7720000000000002,
    3.7760000000000002, 3.7800000000000002, 3.7840000000000003,
    3.7880000000000003, 3.7920000000000003, 3.7960000000000003,
    3.8000000000000003, 3.8040000000000003, 3.8080000000000003,
    3.8120000000000003, 3.8160000000000003, 3.8200000000000003,
    3.8240000000000003, 3.8280000000000003, 3.8320000000000003,
    3.8360000000000003, 3.84, 3.844, 3.848, 3.852, 3.856, 3.86, 3.864, 3.868,
    3.872, 3.876, 3.88, 3.884, 3.888, 3.892, 3.896, 3.9, 3.904, 3.908, 3.912,
    3.916, 3.92, 3.924, 3.928, 3.932, 3.936, 3.94, 3.944, 3.948, 3.952, 3.956,
    3.96, 3.964, 3.968, 3.972, 3.976, 3.98, 3.984, 3.988, 3.992, 3.996, 4.0,
    4.0040000000000004, 4.0080000000000009, 4.0120000000000005, 4.016,
    4.0200000000000005, 4.0240000000000009, 4.0280000000000005, 4.032,
    4.0360000000000005, 4.0400000000000009, 4.0440000000000005, 4.048,
    4.0520000000000005, 4.0560000000000009, 4.0600000000000005, 4.064,
    4.0680000000000005, 4.072000000000001, 4.0760000000000005, 4.08,
    4.0840000000000005, 4.088000000000001, 4.0920000000000005, 4.096,
    4.1000000000000005, 4.104000000000001, 4.1080000000000005, 4.112,
    4.1160000000000005, 4.120000000000001, 4.1240000000000006, 4.128,
    4.1320000000000006, 4.136000000000001, 4.1400000000000006, 4.144,
    4.1480000000000006, 4.152000000000001, 4.1560000000000006, 4.16, 4.164,
    4.168, 4.1720000000000006, 4.176, 4.18, 4.184, 4.1880000000000006, 4.192,
    4.196, 4.2, 4.2040000000000006, 4.208, 4.212, 4.216, 4.2200000000000006,
    4.224, 4.228, 4.232, 4.2360000000000007, 4.24, 4.244, 4.248,
    4.2520000000000007, 4.256, 4.26, 4.264, 4.2680000000000007, 4.272, 4.276,
    4.28, 4.2840000000000007, 4.288, 4.292, 4.296, 4.3000000000000007, 4.304,
    4.308, 4.312, 4.3160000000000007, 4.32, 4.324, 4.328, 4.3320000000000007,
    4.336, 4.34, 4.344, 4.3480000000000008, 4.352, 4.356, 4.36,
    4.3640000000000008, 4.368, 4.372, 4.376, 4.3800000000000008, 4.384, 4.388,
    4.392, 4.3960000000000008, 4.4, 4.404, 4.408, 4.4120000000000008, 4.416,
    4.42, 4.424, 4.4280000000000008, 4.432, 4.436, 4.44, 4.4440000000000008,
    4.448, 4.452, 4.456, 4.4600000000000009, 4.464, 4.468, 4.472,
    4.4760000000000009, 4.48, 4.484, 4.488, 4.4920000000000009, 4.496, 4.5,
    4.5040000000000004, 4.5080000000000009, 4.5120000000000005, 4.516,
    4.5200000000000005, 4.5240000000000009, 4.5280000000000005, 4.532,
    4.5360000000000005, 4.5400000000000009, 4.5440000000000005, 4.548,
    4.5520000000000005, 4.5560000000000009, 4.5600000000000005, 4.564,
    4.5680000000000005, 4.572000000000001, 4.5760000000000005, 4.58,
    4.5840000000000005, 4.588000000000001, 4.5920000000000005, 4.596,
    4.6000000000000005, 4.604000000000001, 4.6080000000000005, 4.612,
    4.6160000000000005, 4.620000000000001, 4.6240000000000006, 4.628,
    4.6320000000000006, 4.636000000000001, 4.6400000000000006, 4.644,
    4.6480000000000006, 4.652000000000001, 4.6560000000000006, 4.66,
    4.6640000000000006, 4.668, 4.6720000000000006, 4.676, 4.68, 4.684,
    4.6880000000000006, 4.692, 4.696, 4.7, 4.7040000000000006, 4.708, 4.712,
    4.716, 4.7200000000000006, 4.724, 4.728, 4.732, 4.7360000000000007, 4.74,
    4.744, 4.748, 4.7520000000000007, 4.756, 4.76, 4.764, 4.7680000000000007,
    4.772, 4.776, 4.78, 4.7840000000000007, 4.788, 4.792, 4.796,
    4.8000000000000007, 4.804, 4.808, 4.812, 4.8160000000000007, 4.82, 4.824,
    4.828, 4.8320000000000007, 4.836, 4.84, 4.844, 4.8480000000000008, 4.852,
    4.856, 4.86, 4.8640000000000008, 4.868, 4.872, 4.876, 4.8800000000000008,
    4.884, 4.888, 4.892, 4.8960000000000008, 4.9, 4.904, 4.908,
    4.9120000000000008, 4.916, 4.92, 4.924, 4.9280000000000008, 4.932, 4.936,
    4.94, 4.9440000000000008, 4.948, 4.952, 4.956, 4.9600000000000009, 4.964,
    4.968, 4.972, 4.9760000000000009, 4.98, 4.984, 4.988, 4.9920000000000009,
    4.996, 5.0, 5.0040000000000004, 5.0080000000000009, 5.0120000000000005,
    5.016, 5.0200000000000005, 5.0240000000000009, 5.0280000000000005, 5.032,
    5.0360000000000005, 5.0400000000000009, 5.0440000000000005, 5.048,
    5.0520000000000005, 5.0560000000000009, 5.0600000000000005, 5.064,
    5.0680000000000005, 5.072000000000001, 5.0760000000000005, 5.08,
    5.0840000000000005, 5.088000000000001, 5.0920000000000005, 5.096,
    5.1000000000000005, 5.104000000000001, 5.1080000000000005, 5.112,
    5.1160000000000005, 5.120000000000001, 5.1240000000000006, 5.128,
    5.1320000000000006, 5.136000000000001, 5.1400000000000006, 5.144,
    5.1480000000000006, 5.152000000000001, 5.1560000000000006, 5.16,
    5.1640000000000006, 5.168000000000001, 5.1720000000000006, 5.176,
    5.1800000000000006, 5.184, 5.1880000000000006, 5.192, 5.196, 5.2,
    5.2040000000000006, 5.208, 5.212, 5.216, 5.2200000000000006, 5.224, 5.228,
    5.232, 5.2360000000000007, 5.24, 5.244, 5.248, 5.2520000000000007, 5.256,
    5.26, 5.264, 5.2680000000000007, 5.272, 5.276, 5.28, 5.2840000000000007,
    5.288, 5.292, 5.296, 5.3000000000000007, 5.304, 5.308, 5.312,
    5.3160000000000007, 5.32, 5.324, 5.328, 5.3320000000000007, 5.336, 5.34,
    5.344, 5.3480000000000008, 5.352, 5.356, 5.36, 5.3640000000000008, 5.368,
    5.372, 5.376, 5.3800000000000008, 5.384, 5.388, 5.392, 5.3960000000000008,
    5.4, 5.404, 5.408, 5.4120000000000008, 5.416, 5.42, 5.424,
    5.4280000000000008, 5.432, 5.436, 5.44, 5.4440000000000008, 5.448, 5.452,
    5.456, 5.4600000000000009, 5.464, 5.468, 5.472, 5.4760000000000009, 5.48,
    5.484, 5.488, 5.4920000000000009, 5.496, 5.5, 5.5040000000000004,
    5.5080000000000009, 5.5120000000000005, 5.516, 5.5200000000000005,
    5.5240000000000009, 5.5280000000000005, 5.532, 5.5360000000000005,
    5.5400000000000009, 5.5440000000000005, 5.548, 5.5520000000000005,
    5.5560000000000009, 5.5600000000000005, 5.564, 5.5680000000000005,
    5.572000000000001, 5.5760000000000005, 5.58, 5.5840000000000005,
    5.588000000000001, 5.5920000000000005, 5.596, 5.6000000000000005,
    5.604000000000001, 5.6080000000000005, 5.612, 5.6160000000000005,
    5.620000000000001, 5.6240000000000006, 5.628, 5.6320000000000006,
    5.636000000000001, 5.6400000000000006, 5.644, 5.6480000000000006,
    5.652000000000001, 5.6560000000000006, 5.66, 5.6640000000000006,
    5.668000000000001, 5.6720000000000006, 5.676, 5.6800000000000006,
    5.6840000000000011, 5.6880000000000006, 5.692, 5.696, 5.7,
    5.7040000000000006, 5.708, 5.712, 5.716, 5.7200000000000006, 5.724, 5.728,
    5.732, 5.7360000000000007, 5.74, 5.744, 5.748, 5.7520000000000007, 5.756,
    5.76, 5.764, 5.7680000000000007, 5.772, 5.776, 5.78, 5.7840000000000007,
    5.788, 5.792, 5.796, 5.8000000000000007, 5.804, 5.808, 5.812,
    5.8160000000000007, 5.82, 5.824, 5.828, 5.8320000000000007, 5.836, 5.84,
    5.844, 5.8480000000000008, 5.852, 5.856, 5.86, 5.8640000000000008, 5.868,
    5.872, 5.876, 5.8800000000000008, 5.884, 5.888, 5.892, 5.8960000000000008,
    5.9, 5.904, 5.908, 5.9120000000000008, 5.916, 5.92, 5.924,
    5.9280000000000008, 5.932, 5.936, 5.94, 5.9440000000000008, 5.948, 5.952,
    5.956, 5.9600000000000009, 5.964, 5.968, 5.972, 5.9760000000000009, 5.98,
    5.984, 5.988, 5.9920000000000009, 5.996, 6.0, 6.0040000000000004,
    6.0080000000000009, 6.0120000000000005, 6.016, 6.0200000000000005,
    6.0240000000000009, 6.0280000000000005, 6.032, 6.0360000000000005,
    6.0400000000000009, 6.0440000000000005, 6.048, 6.0520000000000005,
    6.0560000000000009, 6.0600000000000005, 6.064, 6.0680000000000005,
    6.072000000000001, 6.0760000000000005, 6.08, 6.0840000000000005, 6.088,
    6.0920000000000005, 6.096, 6.1000000000000005, 6.104, 6.1080000000000005,
    6.112, 6.1160000000000005, 6.12, 6.1240000000000006, 6.128,
    6.1320000000000006, 6.136, 6.1400000000000006, 6.144, 6.1480000000000006,
    6.152, 6.1560000000000006, 6.16, 6.1640000000000006, 6.168,
    6.1720000000000006, 6.176, 6.1800000000000006, 6.184, 6.1880000000000006,
    6.192, 6.1960000000000006, 6.2, 6.2040000000000006, 6.208,
    6.2120000000000006, 6.216, 6.2200000000000006, 6.224, 6.2280000000000006,
    6.232, 6.2360000000000007, 6.24, 6.2440000000000007, 6.248,
    6.2520000000000007, 6.256, 6.2600000000000007, 6.264, 6.2680000000000007,
    6.272, 6.2760000000000007, 6.28, 6.2840000000000007, 6.288,
    6.2920000000000007, 6.296, 6.3000000000000007, 6.304, 6.3080000000000007,
    6.312, 6.3160000000000007, 6.32, 6.3240000000000007, 6.328,
    6.3320000000000007, 6.336, 6.34, 6.344, 6.3480000000000008, 6.352, 6.356,
    6.36, 6.3640000000000008, 6.368, 6.372, 6.376, 6.3800000000000008, 6.384,
    6.388, 6.392, 6.3960000000000008, 6.4, 6.404, 6.408, 6.4120000000000008,
    6.416, 6.42, 6.424, 6.4280000000000008, 6.432, 6.436, 6.44,
    6.4440000000000008, 6.448, 6.452, 6.456, 6.4600000000000009, 6.464, 6.468,
    6.472, 6.4760000000000009, 6.48, 6.484, 6.488, 6.4920000000000009, 6.496,
    6.5, 6.5040000000000004, 6.5080000000000009, 6.5120000000000005, 6.516,
    6.5200000000000005, 6.5240000000000009, 6.5280000000000005, 6.532,
    6.5360000000000005, 6.5400000000000009, 6.5440000000000005, 6.548,
    6.5520000000000005, 6.5560000000000009, 6.5600000000000005, 6.564,
    6.5680000000000005, 6.572000000000001, 6.5760000000000005, 6.58,
    6.5840000000000005, 6.588000000000001, 6.5920000000000005, 6.596,
    6.6000000000000005, 6.604, 6.6080000000000005, 6.612, 6.6160000000000005,
    6.62, 6.6240000000000006, 6.628, 6.6320000000000006, 6.636,
    6.6400000000000006, 6.644, 6.6480000000000006, 6.652, 6.6560000000000006,
    6.66, 6.6640000000000006, 6.668, 6.6720000000000006, 6.676,
    6.6800000000000006, 6.684, 6.6880000000000006, 6.692, 6.6960000000000006,
    6.7, 6.7040000000000006, 6.708, 6.7120000000000006, 6.716,
    6.7200000000000006, 6.724, 6.7280000000000006, 6.732, 6.7360000000000007,
    6.74, 6.7440000000000007, 6.748, 6.7520000000000007, 6.756,
    6.7600000000000007, 6.764, 6.7680000000000007, 6.772, 6.7760000000000007,
    6.78, 6.7840000000000007, 6.788, 6.7920000000000007, 6.796,
    6.8000000000000007, 6.804, 6.8080000000000007, 6.812, 6.8160000000000007,
    6.82, 6.8240000000000007, 6.828, 6.8320000000000007, 6.836,
    6.8400000000000007, 6.844, 6.8480000000000008, 6.852, 6.856, 6.86,
    6.8640000000000008, 6.868, 6.872, 6.876, 6.8800000000000008, 6.884, 6.888,
    6.892, 6.8960000000000008, 6.9, 6.904, 6.908, 6.9120000000000008, 6.916,
    6.92, 6.924, 6.9280000000000008, 6.932, 6.936, 6.94, 6.9440000000000008,
    6.948, 6.952, 6.956, 6.9600000000000009, 6.964, 6.968, 6.972,
    6.9760000000000009, 6.98, 6.984, 6.988, 6.9920000000000009, 6.996, 7.0,
    7.0040000000000004, 7.0080000000000009, 7.0120000000000005, 7.016,
    7.0200000000000005, 7.0240000000000009, 7.0280000000000005, 7.032,
    7.0360000000000005, 7.04, 7.0440000000000005, 7.048, 7.0520000000000005,
    7.056, 7.0600000000000005, 7.064, 7.0680000000000005, 7.072,
    7.0760000000000005, 7.08, 7.0840000000000005, 7.088, 7.0920000000000005,
    7.096, 7.1000000000000005, 7.104, 7.1080000000000005, 7.112,
    7.1160000000000005, 7.12, 7.1240000000000006, 7.128, 7.1320000000000006,
    7.136, 7.1400000000000006, 7.144, 7.1480000000000006, 7.152,
    7.1560000000000006, 7.16, 7.1640000000000006, 7.168, 7.1720000000000006,
    7.176, 7.1800000000000006, 7.184, 7.1880000000000006, 7.192,
    7.1960000000000006, 7.2, 7.2040000000000006, 7.208, 7.2120000000000006,
    7.216, 7.2200000000000006, 7.224, 7.2280000000000006, 7.232,
    7.2360000000000007, 7.24, 7.2440000000000007, 7.248, 7.2520000000000007,
    7.256, 7.2600000000000007, 7.264, 7.2680000000000007, 7.272,
    7.2760000000000007, 7.28, 7.2840000000000007, 7.288, 7.2920000000000007,
    7.296, 7.3000000000000007, 7.304, 7.3080000000000007, 7.312,
    7.3160000000000007, 7.32, 7.3240000000000007, 7.328, 7.3320000000000007,
    7.336, 7.3400000000000007, 7.344, 7.3480000000000008, 7.352,
    7.3560000000000008, 7.36, 7.3640000000000008, 7.368, 7.3720000000000008,
    7.376, 7.3800000000000008, 7.384, 7.3880000000000008, 7.392,
    7.3960000000000008, 7.4, 7.4040000000000008, 7.408, 7.4120000000000008,
    7.416, 7.42, 7.424, 7.4280000000000008, 7.432, 7.436, 7.44,
    7.4440000000000008, 7.448, 7.452, 7.456, 7.4600000000000009, 7.464, 7.468,
    7.472, 7.4760000000000009, 7.48, 7.484, 7.488, 7.4920000000000009, 7.496,
    7.5, 7.5040000000000004, 7.5080000000000009, 7.5120000000000005, 7.516,
    7.5200000000000005, 7.524, 7.5280000000000005, 7.532, 7.5360000000000005,
    7.54, 7.5440000000000005, 7.548, 7.5520000000000005, 7.556,
    7.5600000000000005, 7.564, 7.5680000000000005, 7.572, 7.5760000000000005,
    7.58, 7.5840000000000005, 7.588, 7.5920000000000005, 7.596,
    7.6000000000000005, 7.604, 7.6080000000000005, 7.612, 7.6160000000000005,
    7.62, 7.6240000000000006, 7.628, 7.6320000000000006, 7.636,
    7.6400000000000006, 7.644, 7.6480000000000006, 7.652, 7.6560000000000006,
    7.66, 7.6640000000000006, 7.668, 7.6720000000000006, 7.676,
    7.6800000000000006, 7.684, 7.6880000000000006, 7.692, 7.6960000000000006,
    7.7, 7.7040000000000006, 7.708, 7.7120000000000006, 7.716,
    7.7200000000000006, 7.724, 7.7280000000000006, 7.732, 7.7360000000000007,
    7.74, 7.7440000000000007, 7.748, 7.7520000000000007, 7.756,
    7.7600000000000007, 7.764, 7.7680000000000007, 7.772, 7.7760000000000007,
    7.78, 7.7840000000000007, 7.788, 7.7920000000000007, 7.796,
    7.8000000000000007, 7.804, 7.8080000000000007, 7.812, 7.8160000000000007,
    7.82, 7.8240000000000007, 7.828, 7.8320000000000007, 7.836,
    7.8400000000000007, 7.844, 7.8480000000000008, 7.852, 7.8560000000000008,
    7.86, 7.8640000000000008, 7.868, 7.8720000000000008, 7.876,
    7.8800000000000008, 7.884, 7.8880000000000008, 7.892, 7.8960000000000008,
    7.9, 7.9040000000000008, 7.908, 7.9120000000000008, 7.916,
    7.9200000000000008, 7.924, 7.9280000000000008, 7.932, 7.9360000000000008,
    7.94, 7.9440000000000008, 7.948, 7.9520000000000008, 7.956,
    7.9600000000000009, 7.964, 7.9680000000000009, 7.972, 7.9760000000000009,
    7.98, 7.9840000000000009, 7.988, 7.9920000000000009, 7.996 };

  double a[2000];
  double unusedExpr[2000];
  int k;
  double b_unusedExpr[2000];
  static const double dv4[2048] = { 0.0, 2.3553948388377322E-6,
    9.421557163713512E-6, 2.11984204002702E-5, 3.768587359187503E-5,
    5.8883761400674306E-5, 8.4791884109036708E-5, 0.0001154099976216072,
    0.00015073781346730541, 0.0001907749988023788, 0.00023552117641323367,
    0.00028497592472032096, 0.0003391387777817445, 0.00039800922529786842,
    0.00046158671261609108, 0.00052987064073617418, 0.00060286036631551632,
    0.00068055520167575878, 0.00076295441480872528, 0.0008500572293838049,
    0.000941862824754891, 0.0010383703359682084, 0.0011395788537706397,
    0.001245487424618108, 0.0013560950506845693, 0.0014714006898715604,
    0.0015914032558177471, 0.0017161016179095823, 0.0018454946012914086,
    0.0019795809868770609, 0.0021183595113609677, 0.0022618288672302533,
    0.0024099877027770056, 0.0025628346221109877, 0.00272036818517285,
    0.0028825869077476196, 0.0030494892614786884, 0.003221073673882302,
    0.0033973385283623259, 0.0035782821642254548, 0.0037639028766968119,
    0.0039541989169362135, 0.0041491684920543226, 0.0043488097651298019,
    0.0045531208552266889, 0.0047620998374117152, 0.0049757447427728474,
    0.0051940535584376613, 0.0054170242275922709, 0.00564465464950098,
    0.0058769426795255431, 0.0061138861291458735, 0.00635548276598058,
    0.0066017303138076189, 0.0068526264525862746, 0.007108168818478644,
    0.0073683550038720624, 0.0076331825574016965, 0.0079026489839738034,
    0.00817675174478899, 0.0084554882573663614, 0.0087388558955677209,
    0.009026851989622442, 0.0093194738261524468, 0.0096167186481979083,
    0.0099185836552430628, 0.010225066003242855, 0.010536162804649529,
    0.010851871128439827, 0.011172188000142802, 0.011497110401867572,
    0.011826635272331965, 0.012160759506891272, 0.01249947995756745,
    0.012842793433078981, 0.01319069669887063, 0.013543186477144198,
    0.013900259446889329, 0.014261912243914598, 0.01462814146087954,
    0.014998943647326513, 0.015374315309713282, 0.015754252911446,
    0.016138752872912332, 0.016527811571515394, 0.016921425341707763,
    0.017319590475026125, 0.017722303220126079, 0.018129559782817495,
    0.018541356326100322, 0.018957688970200837, 0.019378553792608,
    0.019803946828110375, 0.020233864068833818, 0.020668301464278893,
    0.021107254921359175, 0.021550720304439885, 0.021998693435376748,
    0.022451170093555295, 0.022908146015930775, 0.023369616897068346,
    0.023835578389183487, 0.024306026102182909, 0.0247809556037063,
    0.025260362419167515, 0.025744242031797371, 0.026232589882685509,
    0.026725401370824076, 0.027222671853150415, 0.027724396644591254,
    0.028230571018106665, 0.028741190204734646, 0.029256249393635914,
    0.029775743732139537, 0.030299668325788343, 0.030828018238385213,
    0.031360788492039549, 0.031897974067214063, 0.032439569902772247,
    0.03298557089602594, 0.033535971902783512, 0.034090767737398164,
    0.034649953172816939, 0.035213522940629849, 0.035781471731119618,
    0.036353794193311695, 0.036930484935024488, 0.037511538522920496,
    0.038096949482557152, 0.03868671229843873, 0.039280821414068023,
    0.039879271231998858, 0.04048205611388872, 0.041089170380552154,
    0.041700608312013776, 0.042316364147562624, 0.042936432085806331,
    0.043560806284725473, 0.04418948086172908, 0.044822449893709704,
    0.045459707417099371, 0.046101247427925762, 0.046747063881868778,
    0.047397150694317436, 0.048051501740427216, 0.048710110855177846,
    0.049372971833431256, 0.0500400784299902, 0.05071142435965692,
    0.0513870032972924, 0.05206680887787607, 0.052750834696565829,
    0.053439074308757994, 0.054131521230148583, 0.054828168936793875,
    0.055529010865172257, 0.056234040412245834, 0.056943250935522882,
    0.057656635753120133, 0.058374188143825889, 0.05909590134716336,
    0.059821768563454336, 0.060551782953883249, 0.061285937640561561,
    0.062024225706592717, 0.062766640196137036, 0.063513174114477544,
    0.0642638204280856, 0.065018572064687419, 0.065777421913330636,
    0.066540362824451138, 0.0673073876099406, 0.068078489043214119,
    0.068853659859278327, 0.069632892754799947, 0.070416180388174321,
    0.0712035153795949, 0.071994890311122661, 0.072790297726755715,
    0.073589730132500142, 0.074393179996439962, 0.075200639748808584,
    0.076012101782059915, 0.076827558450939915, 0.077647002072558979,
    0.078470424926463889, 0.079297819254711022, 0.080129177261938911,
    0.080964491115442183, 0.081803752945245112, 0.082646954844175724,
    0.083494088867940464, 0.0843451470351988, 0.085200121327638711,
    0.086059003690052149, 0.086921786030410675, 0.087788460219942133,
    0.088659018093206643, 0.089533451448174373, 0.090411752046301919,
    0.091293911612610523, 0.092179921835763845, 0.093069774368146285,
    0.093963460825941481, 0.094860972789211739, 0.0957623018019767,
    0.096667439372293662, 0.09757637697233712, 0.098489106038479379,
    0.0994056179713711, 0.10032590413602233, 0.10124995586188401,
    0.10217776444292942, 0.10310932113773646, 0.10404461716956975,
    0.10498364372646346, 0.10592639196130449, 0.1068728529919154,
    0.10782301790113857, 0.10877687773691996, 0.10973442351239332,
    0.11069564620596517, 0.11166053676139964, 0.11262908608790373,
    0.11360128506021328, 0.1145771245186783, 0.11555659526935003,
    0.116539688084067, 0.1175263937005423, 0.11851670282245069,
    0.11951060611951614, 0.12050809422759984, 0.1215091577487884,
    0.12251378725148249, 0.12352197327048553, 0.12453370630709287,
    0.12554897682918154, 0.12656777527129959, 0.12759009203475674,
    0.1286159174877145, 0.12964524196527688, 0.1306780557695818,
    0.13171434916989178, 0.13275411240268647, 0.13379733567175411,
    0.13484400914828376, 0.13589412297095838, 0.136947667246047,
    0.13800463204749885, 0.13906500741703609, 0.14012878336424806,
    0.14119594986668521, 0.14226649686995368, 0.14334041428780986,
    0.14441769200225574, 0.14549831986363371, 0.14658228769072262,
    0.14766958527083363, 0.14876020235990622, 0.14985412868260511,
    0.15095135393241643, 0.15205186777174562, 0.15315565983201407,
    0.15426271971375727, 0.15537303698672283, 0.15648660118996832,
    0.15760340183196037, 0.15872342839067294, 0.1598466703136871,
    0.16097311701828976, 0.16210275789157402, 0.16323558229053881,
    0.164371579542189, 0.16551073894363644, 0.16665304976220036,
    0.16779850123550882, 0.16894708257159979, 0.17009878294902309,
    0.17125359151694231, 0.1724114973952367, 0.17357248967460431,
    0.17473655741666416, 0.17590368965405967, 0.17707387539056196,
    0.17824710360117302, 0.17942336323223029, 0.18060264320151037,
    0.18178493239833332, 0.18297021968366778, 0.18415849389023542,
    0.18534974382261654, 0.18654395825735542, 0.18774112594306591,
    0.18894123560053777, 0.19014427592284261, 0.1913502355754404,
    0.19255910319628677, 0.19377086739593941, 0.19498551675766579,
    0.1962030398375505, 0.19742342516460326, 0.19864666124086694,
    0.1998727365415256, 0.2011016395150137, 0.20233335858312423,
    0.20356788214111832, 0.20480519855783424, 0.20604529617579714,
    0.2072881633113291, 0.20853378825465851, 0.2097821592700313,
    0.21103326459582089, 0.21228709244463906, 0.21354363100344731,
    0.21480286843366786, 0.21606479287129537, 0.21732939242700866,
    0.21859665518628246, 0.21986656920950037, 0.22113912253206647,
    0.22241430316451871, 0.22369209909264159, 0.22497249827757931,
    0.22625548865594947, 0.22754105813995623, 0.22882919461750478,
    0.23011988595231508, 0.23141311998403646, 0.23270888452836147,
    0.23400716737714194, 0.23530795629850276, 0.23661123903695819,
    0.23791700331352633, 0.23922523682584529, 0.24053592724828943,
    0.24184906223208469, 0.24316462940542594, 0.24448261637359242,
    0.24580301071906541, 0.24712580000164464, 0.24845097175856617,
    0.24977851350461894, 0.25110841273226325, 0.25244065691174783,
    0.25377523349122832, 0.25511212989688581, 0.2564513335330445,
    0.2577928317822914, 0.25913661200559385, 0.26048266154242017,
    0.26183096771085762, 0.26318151780773286, 0.26453429910873083,
    0.2658892988685152, 0.26724650432084823, 0.26860590267871087,
    0.26996748113442393, 0.27133122685976774, 0.27269712700610371,
    0.27406516870449515, 0.27543533906582895, 0.27680762518093593,
    0.27818201412071408, 0.2795584929362484, 0.28093704865893465,
    0.2823176683006009, 0.28370033885362933, 0.28508504729108, 0.286471780566812,
    0.2878605256156081, 0.28925126935329637, 0.29064399867687463,
    0.29203870046463276, 0.29343536157627736, 0.2948339688530548,
    0.29623450911787563, 0.29763696917543875, 0.29904133581235537,
    0.30044759579727376, 0.30185573588100373, 0.303265742796642,
    0.30467760325969634, 0.3060913039682116, 0.30750683160289405,
    0.30892417282723794, 0.31034331428765038, 0.31176424261357749,
    0.31318694441763045, 0.31461140629571105, 0.31603761482713882,
    0.31746555657477682, 0.31889521808515869, 0.320326585888615,
    0.32175964649940036, 0.32319438641582049, 0.3246307921203595,
    0.32606885007980707, 0.327508546745386, 0.32894986855287978,
    0.33039280192276066, 0.3318373332603175, 0.33328344895578355,
    0.33473113538446531, 0.3361803789068698, 0.3376311658688344,
    0.33908348260165455, 0.340537315422213, 0.34199265063310857,
    0.34344947452278463, 0.34490777336565975, 0.34636753342225535,
    0.34782874093932648, 0.34929138214999045, 0.350755443273857,
    0.35222091051715793, 0.35368777007287761, 0.35515600812088222,
    0.35662561082805039, 0.3580965643484037, 0.35956885482323664,
    0.361042468381248, 0.36251739113867032, 0.36399360919940227,
    0.36547110865513771, 0.36694987558549863, 0.3684298960581649,
    0.36991115612900627, 0.37139364184221357, 0.37287733923042965,
    0.374362234314882, 0.37584831310551381, 0.37733556160111581,
    0.37882396578945826, 0.380313511647423, 0.3818041851411354,
    0.38329597222609707, 0.38478885884731734, 0.38628283093944682,
    0.38777787442690859, 0.38927397522403168, 0.39077111923518404,
    0.39226929235490432, 0.39376848046803586, 0.3952686694498585,
    0.396769845166223, 0.39827199347368303, 0.39977510021962925,
    0.40127915124242219, 0.40278413237152566, 0.40429002942764064,
    0.40579682822283836, 0.40730451456069455, 0.40881307423642266,
    0.41032249303700807, 0.41183275674134157, 0.4133438511203541,
    0.41485576193714979, 0.41636847494714124, 0.41788197589818238,
    0.41939625053070423, 0.420911284577848, 0.42242706376560013,
    0.42394357381292697, 0.42546080043190848, 0.42697872932787384,
    0.42849734619953539, 0.43001663673912394, 0.43153658663252292,
    0.433057181559404, 0.43457840719336105, 0.43610024920204649,
    0.43762269324730479, 0.43914572498530868, 0.44066933006669368,
    0.44219349413669357, 0.4437182028352758, 0.44524344179727615,
    0.44676919665253506, 0.44829545302603163, 0.44982219653802069,
    0.45134941280416674, 0.45287708743568095, 0.45440520603945539,
    0.45593375421819909, 0.45746271757057444, 0.45899208169133165,
    0.46052183217144549, 0.46205195459825033, 0.46358243455557629,
    0.46511325762388495, 0.46664440938040541, 0.46817587539926986,
    0.4697076412516496, 0.47123969250589121, 0.472772014727652,
    0.47430459348003684, 0.47583741432373317, 0.47737046281714812,
    0.47890372451654317, 0.48043718497617188, 0.48197082974841465,
    0.48350464438391577, 0.48503861443171892, 0.48657272543940328,
    0.48810696295322054, 0.48964131251822995, 0.49117575967843563,
    0.49271028997692179, 0.49424488895598934, 0.4957795421572922,
    0.49731423512197365, 0.49884895339080193, 0.50038368250430743,
    0.50191840800291765, 0.50345311542709448, 0.50498779031747043,
    0.50652241821498389, 0.5080569846610169, 0.50959147519752934,
    0.51112587536719711, 0.51266017071354719, 0.51419434678109421,
    0.5157283891154768, 0.51726228326359314, 0.51879601477373782,
    0.52032956919573758, 0.52186293208108814, 0.52339608898308909,
    0.52492902545698117, 0.52646172706008143, 0.5279941793519205,
    0.52952636789437724, 0.531058278251816, 0.53258989599122131,
    0.53412120668233543, 0.53565219589779312, 0.537182849213258,
    0.53871315220755833, 0.540243090462823, 0.54177264956461746,
    0.54330181510207909, 0.54483057266805368, 0.54635890785923014,
    0.54788680627627739, 0.54941425352397932, 0.55094123521137028,
    0.55246773695187146, 0.55399374436342519, 0.55551924306863176,
    0.557044218694884, 0.558568656874503, 0.56009254324487356,
    0.56161586344857939, 0.563138603133538, 0.56466074795313692,
    0.56618228356636791, 0.56770319563796223, 0.56922346983852634,
    0.570743091844676, 0.57226204733917208, 0.57378032201105478,
    0.57529790155577887, 0.576814771675348, 0.57833091807845027,
    0.57984632648059176, 0.5813609826042323, 0.58287487217891876,
    0.5843879809414203, 0.58590029463586291, 0.58741179901386276,
    0.58892247983466184, 0.59043232286526059, 0.59194131388055327,
    0.593449438663461, 0.59495668300506688, 0.59646303270474832,
    0.59796847357031246, 0.59947299141812849, 0.60097657207326216,
    0.602479201369609, 0.6039808651500278, 0.60548154926647435,
    0.60698123958013384, 0.60847992196155509, 0.60997758229078314,
    0.6114742064574924, 0.61296978036111949, 0.61446428991099611,
    0.61595772102648194, 0.6174500596370972, 0.61894129168265555,
    0.62043140311339551, 0.62192037989011428, 0.62340820798429875,
    0.62489487337825866, 0.62638036206525793, 0.62786466004964736,
    0.629347753346995, 0.63082962798422026, 0.63231026999972351,
    0.63378966544351822, 0.6352678003773633, 0.63674466087489268,
    0.63822023302174835, 0.63969450291571006, 0.64116745666682706,
    0.6426390803975488, 0.64410936024285537, 0.64557828235038839,
    0.647045832880582, 0.64851199800679227, 0.64997676391542814,
    0.65144011680608127, 0.65290204289165632, 0.65436252839850084,
    0.65582155956653432, 0.65727912264937938, 0.65873520391448925,
    0.66018978964327912, 0.66164286613125389, 0.66309441968813809,
    0.664544436638005, 0.66599290331940453, 0.66743980608549314,
    0.66888513130416127, 0.670328865358163, 0.67177099464524337,
    0.6732115055782667, 0.67465038458534488, 0.67608761810996543,
    0.67752319261111849, 0.6789570945634249, 0.6803893104572637,
    0.68181982679889908, 0.683248630110608, 0.68467570693080648,
    0.68610104381417747, 0.68752462733179565, 0.6889464440712566,
    0.69036648063680073, 0.691784723649441, 0.69320115974708851,
    0.69461577558467757, 0.6960285578342934, 0.69743949318529563,
    0.698848568344445, 0.7002557700360279, 0.70166108500198221,
    0.70306450000202114, 0.70446600181375918, 0.70586557723283561,
    0.70726321307303985, 0.7086588961664344, 0.7100526133634808,
    0.71144435153316155, 0.712834097563105, 0.71422183835970876,
    0.71560756084826294, 0.71699125197307279, 0.71837289869758281,
    0.71975248800449876, 0.72113000689591056, 0.72250544239341452,
    0.72387878153823582, 0.72525001139135137, 0.72661911903360943,
    0.727986091565854, 0.72935091610904523, 0.73071357980438012,
    0.7320740698134145, 0.73343237331818367, 0.7347884775213237,
    0.73614236964619117, 0.73749403693698368, 0.738843466658861,
    0.74019064609806373, 0.74153556256203368, 0.74287820337953381,
    0.74421855590076713, 0.74555660749749619, 0.74689234556316131,
    0.74822575751300047, 0.74955683078416735, 0.75088555283584935,
    0.75221191114938635, 0.753535893228388, 0.75485748659885221,
    0.75617667880928208, 0.75749345743080343, 0.75880781005728237,
    0.76011972430544106, 0.76142918781497526, 0.76273618824867073,
    0.764040713292519, 0.76534275065583435, 0.76664228807136781,
    0.76793931329542464, 0.76923381410797909, 0.77052577831278857,
    0.77181519373751006, 0.77310204823381379, 0.77438632967749821,
    0.7756680259686034, 0.77694712503152619, 0.77822361481513347,
    0.77949748329287527, 0.78076871846289841, 0.78203730834816021,
    0.78330324099654036, 0.78456650448095366, 0.78582708689946323,
    0.78708497637539154, 0.78834016105743354, 0.78959262911976658,
    0.790842368762164, 0.792089368210104, 0.79333361571488259,
    0.79457509955372307, 0.7958138080298871, 0.79704972947278452,
    0.79828285223808315, 0.79951316470781908, 0.80074065529050575,
    0.80196531242124358, 0.80318712456182761, 0.804406080200858,
    0.80562216785384777, 0.80683537606333022, 0.80804569339896815,
    0.80925310845766063, 0.81045760986365112, 0.81165918626863354,
    0.81285782635186088, 0.81405351882025045, 0.81524625240849069,
    0.81643601587914716, 0.81762279802276927, 0.81880658765799486,
    0.81998737363165575, 0.82116514481888325, 0.82233989012321262,
    0.82351159847668809, 0.8246802588399661, 0.82584586020242035,
    0.827008391582245, 0.8281678420265588, 0.82932420061150691,
    0.83047745644236526, 0.83162759865364277, 0.83277461640918315,
    0.83391849890226755, 0.83505923535571636, 0.83619681502199072,
    0.83733122718329334, 0.83846246115166989, 0.83959050626910992,
    0.840715351907647, 0.84183698746945845, 0.84295540238696576,
    0.8440705861229344, 0.84518252817057193, 0.84629121805362817,
    0.84739664532649361, 0.84849879957429764, 0.84959767041300593,
    0.85069324748952013, 0.85178552048177358, 0.85287447909883007,
    0.85396011308097908, 0.855042412199834, 0.85612136625842816,
    0.85719696509130983, 0.85826919856463957, 0.85933805657628448,
    0.860403529055914, 0.86146560596509458, 0.86252427729738423,
    0.86357953307842727, 0.8646313633660474, 0.86567975825034216,
    0.866724707853776, 0.86776620233127333, 0.86880423187031108,
    0.86983878669101178, 0.870869857046235, 0.87189743322166979,
    0.87292150553592518, 0.87394206434062283, 0.87495910002048727,
    0.87597260299343582, 0.87698256371066985, 0.87798897265676423,
    0.87899182034975754, 0.87999109734124037, 0.8809867942164451,
    0.881978901594335, 0.88296741012769153, 0.883952310503203,
    0.88493359344155231, 0.88591124969750457, 0.88688527005999385,
    0.88785564535220984, 0.88882236643168466, 0.88978542419037931,
    0.89074480955476831, 0.89170051348592627, 0.892652526979613,
    0.89360084106635784, 0.89454544681154413, 0.895486335315494,
    0.8964234977135519, 0.89735692517616794, 0.89828660890898093,
    0.89921254015290208, 0.90013471018419644, 0.901053110314566,
    0.901967731891231, 0.9028785662970118, 0.90378560495040983,
    0.90468883930568811, 0.90558826085295263, 0.9064838611182322,
    0.9073756316635575, 0.90826356408704179, 0.90914765002295916,
    0.91002788114182376, 0.9109042491504683, 0.911776745792122,
    0.91264536284648856, 0.9135100921298237, 0.91437092549501142,
    0.91522785483164215, 0.91608087206608824, 0.91692996916157987,
    0.91777513811828138, 0.91861637097336635, 0.91945365980109306,
    0.920286996712878, 0.92111637385737133, 0.92194178342053057,
    0.92276321762569413, 0.9235806687336543, 0.92439412904273055,
    0.92520359088884241, 0.92600904664558037, 0.92681048872427918,
    0.927607909574089, 0.92840130168204582, 0.92919065757314279,
    0.92997596981040109, 0.93075723099493879, 0.93153443376604206,
    0.93230757080123294, 0.93307663481633973, 0.93384161856556469,
    0.93460251484155255, 0.93535931647545889, 0.93611201633701713,
    0.93686060733460552, 0.93760508241531482, 0.93834543456501385,
    0.93908165680841615, 0.93981374220914538, 0.94054168386980086,
    0.94126547493202251, 0.94198510857655537, 0.94270057802331375,
    0.94341187653144587, 0.944118997399396, 0.94482193396496916,
    0.94552067960539232, 0.94621522773737832, 0.9469055718171866,
    0.94759170534068582, 0.94827362184341424, 0.94895131490064166,
    0.94962477812742918, 0.95029400517868945, 0.95095898974924664,
    0.951619725573896, 0.95227620642746247, 0.95292842612485962,
    0.95357637852114774, 0.954220057511592, 0.95485945703171971,
    0.95549457105737745, 0.956125393604788, 0.95675191873060683,
    0.95737414053197778, 0.95799205314658842, 0.95860565075272641,
    0.95921492756933313, 0.9598198778560586, 0.9604204959133158,
    0.96101677608233382, 0.961608712745212, 0.96219630032497183,
    0.9627795332856105, 0.9633584061321524, 0.963932913410701,
    0.96450304970849032, 0.965068809653936, 0.965630187916686,
    0.96618717920767039, 0.96673977827915136, 0.967287979924773,
    0.96783177897961015, 0.96837117032021669, 0.96890614886467419,
    0.96943670957264017, 0.96996284744539452, 0.9704845575258878,
    0.97100183489878678, 0.97151467469052188, 0.97202307206933225,
    0.97252702224531151, 0.97302652047045324, 0.97352156203869522,
    0.974012142285964, 0.97449825659021894, 0.9749799003714954,
    0.9754570690919484, 0.9759297582558949, 0.97639796340985652,
    0.97686168014260133, 0.9773209040851849, 0.97777563091099284,
    0.97822585633578019, 0.97867157611771227, 0.97911278605740493,
    0.97954948199796354, 0.97998165982502283, 0.980409315466785,
    0.98083244489405863, 0.98125104412029585, 0.9816651092016313,
    0.9820746362369176, 0.98247962136776346, 0.98288006077856926,
    0.98327595069656359, 0.98366728739183773, 0.98405406717738231,
    0.98443628640912073, 0.984813941485944, 0.98518702884974529,
    0.985555544985452, 0.98591948642106031, 0.98627884972766688,
    0.98663363151950212, 0.98698382845396093, 0.98732943723163535,
    0.98767045459634473, 0.9880068773351669, 0.98833870227846843,
    0.988665926299934, 0.98898854631659683, 0.98930655928886679,
    0.98961996222055937, 0.989928752158924, 0.99023292619467163,
    0.99053248146200246, 0.99082741513863315, 0.99111772444582213,
    0.99140340664839766, 0.991684459054782, 0.99196087901701746,
    0.99223266393079168, 0.99249981123546138, 0.99276231841407714,
    0.99302018299340666, 0.99327340254395835, 0.99352197468000414,
    0.99376589705960194, 0.99400516738461775, 0.994239783400747,
    0.99446974289753642, 0.99469504370840445, 0.99491568371066152,
    0.99513166082553028, 0.99534297301816532, 0.99554961829767208,
    0.99575159471712549, 0.99594890037358885, 0.99614153340813116,
    0.996329492005845, 0.9965127743958635, 0.99669137885137726, 0.99686530368965,
    0.99703454727203522, 0.997199108003991, 0.9973589843350954,
    0.99751417475906079, 0.99766467781374835, 0.99781049208118144,
    0.99795161618755968, 0.99808804880327084, 0.99821978864290439,
    0.99834683446526284, 0.998469185073374, 0.99858683931450165,
    0.99869979608015735, 0.99880805430610986, 0.99891161297239561,
    0.99901047110332852, 0.99910462776750886, 0.99919408207783222,
    0.99927883319149746, 0.9993588803100153, 0.99943422267921567,
    0.99950485958925439, 0.99957079037462, 0.99963201441414062,
    0.9996885311309891, 0.99974033999268852, 0.99978744051111779,
    0.99982983224251543, 0.99986751478748448, 0.99990048779099583,
    0.99992875094239175, 0.99995230397538859, 0.99997114666807985,
    0.99998527884293731, 0.99999470036681382, 0.9999994111509436,
    0.9999994111509436, 0.99999470036681382, 0.99998527884293731,
    0.99997114666807985, 0.99995230397538859, 0.99992875094239175,
    0.99990048779099583, 0.99986751478748448, 0.99982983224251543,
    0.99978744051111779, 0.99974033999268852, 0.9996885311309891,
    0.99963201441414073, 0.99957079037462, 0.99950485958925439,
    0.99943422267921567, 0.9993588803100153, 0.99927883319149746,
    0.99919408207783222, 0.99910462776750886, 0.99901047110332863,
    0.99891161297239561, 0.99880805430611, 0.99869979608015735,
    0.99858683931450165, 0.998469185073374, 0.99834683446526284,
    0.9982197886429045, 0.99808804880327084, 0.99795161618755968,
    0.99781049208118144, 0.99766467781374835, 0.99751417475906079,
    0.9973589843350954, 0.997199108003991, 0.99703454727203522, 0.99686530368965,
    0.99669137885137726, 0.9965127743958635, 0.996329492005845,
    0.99614153340813116, 0.99594890037358885, 0.9957515947171256,
    0.99554961829767208, 0.99534297301816532, 0.99513166082553028,
    0.99491568371066152, 0.99469504370840456, 0.99446974289753642,
    0.994239783400747, 0.99400516738461775, 0.99376589705960194,
    0.99352197468000414, 0.99327340254395846, 0.99302018299340666,
    0.99276231841407714, 0.99249981123546149, 0.99223266393079168,
    0.99196087901701746, 0.991684459054782, 0.99140340664839766,
    0.99111772444582225, 0.99082741513863315, 0.99053248146200257,
    0.99023292619467163, 0.989928752158924, 0.98961996222055937,
    0.98930655928886679, 0.98898854631659683, 0.988665926299934,
    0.98833870227846843, 0.9880068773351669, 0.98767045459634473,
    0.98732943723163547, 0.986983828453961, 0.98663363151950212,
    0.98627884972766688, 0.98591948642106031, 0.98555554498545206,
    0.98518702884974529, 0.984813941485944, 0.98443628640912073,
    0.98405406717738231, 0.98366728739183773, 0.98327595069656359,
    0.98288006077856949, 0.98247962136776357, 0.9820746362369176,
    0.9816651092016313, 0.981251044120296, 0.98083244489405852,
    0.980409315466785, 0.97998165982502294, 0.97954948199796377,
    0.97911278605740493, 0.97867157611771238, 0.9782258563357803,
    0.97777563091099284, 0.9773209040851849, 0.97686168014260122,
    0.97639796340985652, 0.975929758255895, 0.9754570690919484,
    0.9749799003714954, 0.97449825659021894, 0.974012142285964,
    0.97352156203869522, 0.97302652047045335, 0.97252702224531151,
    0.97202307206933214, 0.97151467469052188, 0.97100183489878689,
    0.9704845575258878, 0.96996284744539463, 0.96943670957264017,
    0.9689061488646743, 0.96837117032021669, 0.96783177897961026,
    0.96728797992477311, 0.96673977827915136, 0.96618717920767039,
    0.96563018791668609, 0.96506880965393615, 0.96450304970849032,
    0.96393291341070109, 0.96335840613215251, 0.96277953328561061,
    0.96219630032497183, 0.961608712745212, 0.96101677608233382,
    0.96042049591331569, 0.9598198778560586, 0.95921492756933313,
    0.95860565075272652, 0.95799205314658853, 0.95737414053197778,
    0.95675191873060694, 0.95612539360478821, 0.95549457105737734,
    0.95485945703171971, 0.954220057511592, 0.95357637852114774,
    0.95292842612485962, 0.95227620642746258, 0.95161972557389607,
    0.95095898974924664, 0.95029400517868945, 0.94962477812742918,
    0.94895131490064166, 0.94827362184341424, 0.94759170534068571,
    0.94690557181718671, 0.94621522773737832, 0.94552067960539243,
    0.94482193396496927, 0.9441189973993962, 0.94341187653144587,
    0.94270057802331386, 0.94198510857655537, 0.94126547493202262,
    0.94054168386980086, 0.93981374220914549, 0.93908165680841627,
    0.938345434565014, 0.93760508241531482, 0.93686060733460563,
    0.93611201633701724, 0.935359316475459, 0.93460251484155243,
    0.93384161856556458, 0.93307663481633973, 0.93230757080123294,
    0.93153443376604206, 0.930757230994939, 0.92997596981040109,
    0.9291906575731429, 0.92840130168204582, 0.92760790957408912,
    0.92681048872427918, 0.92600904664558026, 0.9252035908888423,
    0.92439412904273066, 0.9235806687336543, 0.92276321762569413,
    0.92194178342053079, 0.92111637385737133, 0.920286996712878,
    0.91945365980109317, 0.91861637097336657, 0.91777513811828126,
    0.91692996916157976, 0.91608087206608824, 0.91522785483164237,
    0.91437092549501153, 0.91351009212982381, 0.91264536284648878,
    0.91177674579212209, 0.91090424915046841, 0.91002788114182365,
    0.90914765002295916, 0.90826356408704179, 0.90737563166355761,
    0.90648386111823231, 0.90558826085295274, 0.90468883930568822,
    0.90378560495040983, 0.902878566297012, 0.90196773189123114,
    0.90105311031456592, 0.90013471018419633, 0.89921254015290208,
    0.89828660890898093, 0.89735692517616794, 0.89642349771355212,
    0.89548633531549415, 0.89454544681154424, 0.89360084106635784,
    0.89265252697961317, 0.89170051348592616, 0.8907448095547682,
    0.88978542419037931, 0.88882236643168488, 0.88785564535221,
    0.886885270059994, 0.88591124969750479, 0.88493359344155242,
    0.883952310503203, 0.88296741012769164, 0.88197890159433512,
    0.8809867942164451, 0.87999109734124037, 0.87899182034975754,
    0.87798897265676445, 0.87698256371066985, 0.87597260299343593,
    0.87495910002048738, 0.873942064340623, 0.87292150553592518,
    0.87189743322166968, 0.8708698570462351, 0.86983878669101178,
    0.86880423187031108, 0.86776620233127333, 0.8667247078537762,
    0.86567975825034227, 0.86463136336604762, 0.8635795330784275,
    0.86252427729738435, 0.86146560596509447, 0.860403529055914,
    0.85933805657628459, 0.85826919856463957, 0.85719696509130994,
    0.85612136625842827, 0.85504241219983435, 0.85396011308097908,
    0.85287447909883007, 0.85178552048177381, 0.85069324748952,
    0.84959767041300593, 0.84849879957429764, 0.84739664532649384,
    0.84629121805362839, 0.845182528170572, 0.84407058612293451,
    0.84295540238696609, 0.84183698746945845, 0.84071535190764712,
    0.83959050626911, 0.83846246115166978, 0.83733122718329323,
    0.83619681502199072, 0.83505923535571658, 0.83391849890226766,
    0.83277461640918327, 0.831627598653643, 0.83047745644236559,
    0.82932420061150691, 0.8281678420265588, 0.82700839158224526,
    0.82584586020242068, 0.82468025883996632, 0.82351159847668831,
    0.82233989012321285, 0.82116514481888314, 0.81998737363165586,
    0.81880658765799486, 0.81762279802276916, 0.81643601587914727,
    0.81524625240849058, 0.81405351882025034, 0.8128578263518611,
    0.81165918626863376, 0.810457609863651, 0.80925310845766085,
    0.80804569339896826, 0.80683537606333056, 0.805622167853848,
    0.80440608020085813, 0.80318712456182784, 0.80196531242124369,
    0.80074065529050609, 0.79951316470781952, 0.798282852238083,
    0.7970497294727843, 0.79581380802988722, 0.79457509955372307,
    0.7933336157148827, 0.792089368210104, 0.79084236876216374,
    0.7895926291197668, 0.78834016105743365, 0.78708497637539165,
    0.78582708689946346, 0.78456650448095377, 0.78330324099654025,
    0.78203730834816043, 0.78076871846289864, 0.7794974832928756,
    0.7782236148151338, 0.77694712503152652, 0.77566802596860385,
    0.77438632967749843, 0.77310204823381379, 0.77181519373751017,
    0.77052577831278857, 0.76923381410797886, 0.76793931329542475,
    0.76664228807136769, 0.76534275065583457, 0.76404071329251932,
    0.76273618824867073, 0.76142918781497548, 0.76011972430544117,
    0.75880781005728237, 0.75749345743080376, 0.75617667880928208,
    0.75485748659885221, 0.75353589322838821, 0.75221191114938657,
    0.7508855528358499, 0.74955683078416779, 0.7482257575130008,
    0.74689234556316142, 0.74555660749749608, 0.744218555900767,
    0.74287820337953392, 0.74153556256203357, 0.7401906460980634,
    0.73884346665886114, 0.73749403693698379, 0.73614236964619151,
    0.734788477521324, 0.73343237331818378, 0.73207406981341472,
    0.73071357980438023, 0.72935091610904523, 0.72798609156585437,
    0.72661911903360954, 0.72525001139135126, 0.72387878153823637,
    0.72250544239341474, 0.72113000689591111, 0.71975248800449887,
    0.71837289869758281, 0.7169912519730729, 0.71560756084826282,
    0.71422183835970865, 0.71283409756310512, 0.71144435153316143,
    0.71005261336348069, 0.70865889616643463, 0.70726321307303985,
    0.705865577232836, 0.7044660018137594, 0.70306450000202125,
    0.70166108500198254, 0.70025577003602812, 0.698848568344445,
    0.697439493185296, 0.69602855783429363, 0.6946157755846778,
    0.69320115974708885, 0.691784723649441, 0.690366480636801,
    0.6889464440712566, 0.68752462733179565, 0.68610104381417747,
    0.68467570693080659, 0.68324863011060788, 0.6818198267988993,
    0.6803893104572637, 0.67895709456342479, 0.67752319261111871,
    0.67608761810996554, 0.67465038458534488, 0.67321150557826692,
    0.67177099464524348, 0.67032886535816349, 0.66888513130416161,
    0.66743980608549314, 0.665992903319405, 0.66454443663800522,
    0.66309441968813787, 0.66164286613125389, 0.660189789643279,
    0.658735203914489, 0.65727912264937938, 0.65582155956653432,
    0.65436252839850106, 0.65290204289165643, 0.65144011680608127,
    0.64997676391542836, 0.64851199800679238, 0.647045832880582,
    0.64557828235038872, 0.64410936024285537, 0.6426390803975488,
    0.6411674566668274, 0.63969450291571028, 0.6382202330217488,
    0.636744660874893, 0.635267800377363, 0.63378966544351834,
    0.6323102699997234, 0.63082962798422, 0.62934775334699511,
    0.62786466004964714, 0.62638036206525793, 0.62489487337825877,
    0.62340820798429875, 0.62192037989011451, 0.62043140311339562,
    0.61894129168265555, 0.61745005963709754, 0.615957721026482,
    0.61446428991099611, 0.61296978036111982, 0.61147420645749262,
    0.60997758229078325, 0.60847992196155554, 0.60698123958013406,
    0.60548154926647435, 0.6039808651500278, 0.60247920136960875,
    0.60097657207326227, 0.59947299141812849, 0.59796847357031235,
    0.59646303270474854, 0.59495668300506688, 0.59344943866346089,
    0.59194131388055338, 0.59043232286526059, 0.58892247983466217,
    0.587411799013863, 0.58590029463586291, 0.58438798094142064,
    0.58287487217891887, 0.58136098260423241, 0.5798463264805922,
    0.5783309180784505, 0.57681477167534811, 0.57529790155577876,
    0.57378032201105467, 0.57226204733917219, 0.570743091844676,
    0.56922346983852612, 0.56770319563796234, 0.56618228356636791,
    0.56466074795313681, 0.56313860313353825, 0.56161586344857939,
    0.56009254324487356, 0.55856865687450319, 0.55704421869488407,
    0.5555192430686321, 0.55399374436342541, 0.55246773695187157,
    0.55094123521137073, 0.54941425352397955, 0.5478868062762775,
    0.54635890785923058, 0.54483057266805346, 0.54330181510207887,
    0.54177264956461746, 0.54024309046282293, 0.53871315220755855,
    0.5371828492132581, 0.53565219589779312, 0.53412120668233565,
    0.53258989599122142, 0.53105827825181584, 0.52952636789437757,
    0.52799417935192061, 0.52646172706008143, 0.52492902545698139,
    0.5233960889830892, 0.52186293208108858, 0.520329569195738,
    0.51879601477373793, 0.51726228326359358, 0.51572838911547714,
    0.514194346781094, 0.5126601707135473, 0.511125875367197,
    0.50959147519752912, 0.5080569846610169, 0.506522418214984,
    0.50498779031747065, 0.50345311542709459, 0.50191840800291754,
    0.50038368250430765, 0.49884895339080221, 0.4973142351219737,
    0.49577954215729259, 0.49424488895598945, 0.49271028997692179,
    0.491175759678436, 0.48964131251823018, 0.488106962953221,
    0.48657272543940361, 0.48503861443171908, 0.48350464438391588,
    0.48197082974841465, 0.48043718497617166, 0.47890372451654328,
    0.477370462817148, 0.47583741432373311, 0.47430459348003695,
    0.472772014727652, 0.47123969250589143, 0.46970764125164977,
    0.46817587539926986, 0.46664440938040574, 0.46511325762388517,
    0.46358243455557629, 0.46205195459825066, 0.46052183217144571,
    0.45899208169133177, 0.45746271757057477, 0.45593375421819932,
    0.45440520603945583, 0.45287708743568095, 0.45134941280416668,
    0.4498221965380208, 0.44829545302603163, 0.44676919665253484,
    0.44524344179727637, 0.4437182028352758, 0.44219349413669345,
    0.44066933006669379, 0.43914572498530868, 0.43762269324730513,
    0.43610024920204671, 0.43457840719336122, 0.43305718155940431,
    0.4315365866325232, 0.43001663673912405, 0.42849734619953583,
    0.42697872932787406, 0.42546080043190859, 0.42394357381292735,
    0.4224270637656, 0.4209112845778481, 0.41939625053070423,
    0.41788197589818232, 0.41636847494714135, 0.4148557619371499,
    0.413343851120354, 0.41183275674134179, 0.41032249303700807,
    0.40881307423642255, 0.40730451456069477, 0.40579682822283847,
    0.404290029427641, 0.40278413237152594, 0.40127915124242231,
    0.3997751002196297, 0.39827199347368336, 0.3967698451662231,
    0.39526866944985894, 0.39376848046803609, 0.3922692923549041,
    0.39077111923518404, 0.38927397522403162, 0.3877778744269087,
    0.38628283093944682, 0.38478885884731734, 0.38329597222609729,
    0.38180418514113551, 0.38031351164742289, 0.37882396578945854,
    0.37733556160111592, 0.37584831310551381, 0.37436223431488225,
    0.37287733923042976, 0.37139364184221391, 0.3699111561290066,
    0.36842989605816512, 0.36694987558549907, 0.36547110865513804,
    0.36399360919940238, 0.36251739113867043, 0.36104246838124787,
    0.35956885482323647, 0.3580965643484037, 0.35662561082805033,
    0.35515600812088244, 0.35368777007287772, 0.35222091051715793,
    0.35075544327385721, 0.34929138214999056, 0.34782874093932648,
    0.34636753342225568, 0.34490777336565986, 0.34344947452278468,
    0.3419926506331088, 0.34053731542221322, 0.33908348260165511,
    0.33763116586883474, 0.33618037890687, 0.33473113538446575,
    0.33328344895578355, 0.33183733326031728, 0.33039280192276077,
    0.32894986855287967, 0.32750854674538576, 0.32606885007980718,
    0.3246307921203595, 0.32319438641582082, 0.32175964649940048,
    0.320326585888615, 0.31889521808515897, 0.31746555657477704,
    0.31603761482713882, 0.31461140629571133, 0.31318694441763062,
    0.3117642426135776, 0.31034331428765072, 0.30892417282723816,
    0.30750683160289416, 0.30609130396821194, 0.30467760325969623,
    0.30326574279664209, 0.30185573588100373, 0.30044759579727354,
    0.29904133581235548, 0.29763696917543875, 0.29623450911787552,
    0.29483396885305491, 0.29343536157627736, 0.29203870046463265,
    0.29064399867687485, 0.28925126935329648, 0.28786052561560838,
    0.28647178056681222, 0.28508504729108, 0.28370033885362972,
    0.28231766830060107, 0.28093704865893476, 0.27955849293624868,
    0.27818201412071425, 0.27680762518093577, 0.27543533906582895,
    0.2740651687044951, 0.27269712700610382, 0.27133122685976774,
    0.26996748113442381, 0.26860590267871109, 0.26724650432084823,
    0.26588929886851514, 0.26453429910873105, 0.26318151780773297,
    0.26183096771085762, 0.26048266154242039, 0.25913661200559396,
    0.25779283178229168, 0.25645133353304483, 0.25511212989688592,
    0.25377523349122871, 0.252440656911748, 0.25110841273226336,
    0.24977851350461905, 0.24845097175856612, 0.24712580000164447,
    0.24580301071906541, 0.24448261637359231, 0.2431646294054261,
    0.2418490622320848, 0.24053592724828932, 0.23922523682584551,
    0.23791700331352639, 0.23661123903695819, 0.2353079562985031,
    0.234007167377142, 0.23270888452836147, 0.23141311998403663,
    0.23011988595231531, 0.22882919461750523, 0.22754105813995651,
    0.22625548865594963, 0.22497249827757976, 0.22369209909264148,
    0.22241430316451849, 0.22113912253206652, 0.21986656920950026,
    0.2185966551862823, 0.21732939242700872, 0.21606479287129537,
    0.21480286843366808, 0.21354363100344742, 0.21228709244463906,
    0.21103326459582111, 0.20978215927003147, 0.20853378825465851,
    0.20728816331132932, 0.20604529617579731, 0.20480519855783424,
    0.20356788214111859, 0.2023333585831244, 0.20110163951501414,
    0.19987273654152593, 0.19864666124086677, 0.19742342516460337,
    0.19620303983755044, 0.19498551675766562, 0.19377086739593952,
    0.19255910319628677, 0.19135023557544029, 0.19014427592284266,
    0.18894123560053777, 0.18774112594306619, 0.18654395825735554,
    0.1853497438226166, 0.18415849389023564, 0.18297021968366789,
    0.18178493239833338, 0.18060264320151065, 0.17942336323223046,
    0.17824710360117307, 0.17707387539056224, 0.17590368965405989,
    0.17473655741666427, 0.17357248967460431, 0.17241149739523659,
    0.17125359151694242, 0.17009878294902314, 0.16894708257159968,
    0.16779850123550893, 0.16665304976220041, 0.16551073894363633,
    0.16437157954218912, 0.16323558229053881, 0.1621027578915743,
    0.16097311701828992, 0.15984667031368716, 0.15872342839067322,
    0.15760340183196053, 0.15648660118996843, 0.15537303698672311,
    0.15426271971375749, 0.15315565983201385, 0.15205186777174562,
    0.15095135393241638, 0.14985412868260523, 0.14876020235990628,
    0.14766958527083357, 0.14658228769072273, 0.14549831986363371,
    0.14441769200225568, 0.14334041428781003, 0.14226649686995374,
    0.14119594986668516, 0.14012878336424822, 0.1390650074170362,
    0.13800463204749913, 0.13694766724604723, 0.13589412297095843,
    0.13484400914828409, 0.13379733567175434, 0.13275411240268659,
    0.13171434916989178, 0.13067805576958169, 0.12964524196527671,
    0.1286159174877145, 0.12759009203475669, 0.12656777527129975,
    0.12554897682918154, 0.12453370630709287, 0.1235219732704857,
    0.1225137872514826, 0.1215091577487884, 0.1205080942276, 0.11951060611951619,
    0.11851670282245069, 0.11752639370054252, 0.11653968808406712,
    0.11555659526935036, 0.11457712451867852, 0.11360128506021339,
    0.11262908608790406, 0.11166053676139959, 0.110695646205965,
    0.10973442351239338, 0.10877687773691991, 0.10782301790113852,
    0.10687285299191551, 0.10592639196130449, 0.10498364372646363,
    0.10404461716956981, 0.10310932113773646, 0.10217776444292959,
    0.10124995586188412, 0.10032590413602233, 0.099405617971371263,
    0.09848910603847949, 0.097576376972337175, 0.096667439372293884,
    0.095762301801976868, 0.094860972789212017, 0.093963460825941758,
    0.093069774368146119, 0.0921799218357639, 0.091293911612610468,
    0.090411752046301808, 0.089533451448174428, 0.0886590180932067,
    0.087788460219942022, 0.086921786030410786, 0.086059003690052149,
    0.085200121327638934, 0.084345147035198853, 0.083494088867940464,
    0.082646954844175891, 0.081803752945245223, 0.080964491115442239,
    0.080129177261939133, 0.079297819254711133, 0.078470424926464,
    0.0776470020725592, 0.076827558450940081, 0.076012101782059971,
    0.075200639748808584, 0.074393179996439851, 0.0735897301325002,
    0.072790297726755715, 0.07199489031112255, 0.071203515379595017,
    0.070416180388174321, 0.069632892754799891, 0.068853659859278438,
    0.068078489043214119, 0.067307387609940761, 0.066540362824451249,
    0.065777421913330691, 0.065018572064687641, 0.0642638204280857,
    0.063513174114477544, 0.062766640196137258, 0.062024225706592884,
    0.061285937640561672, 0.060551782953883249, 0.059821768563454281,
    0.059095901347163415, 0.058374188143825889, 0.057656635753120078,
    0.056943250935522993, 0.056234040412245889, 0.0555290108651722,
    0.054828168936793986, 0.054131521230148638, 0.053439074308757994,
    0.05275083469656594, 0.052066808877876125, 0.051387003297292566,
    0.050711424359657031, 0.050040078429990253, 0.049372971833431478,
    0.048710110855177957, 0.048051501740427272, 0.0473971506943176,
    0.046747063881868722, 0.046101247427925651, 0.045459707417099371,
    0.044822449893709648, 0.044189480861729136, 0.043560806284725473,
    0.042936432085806275, 0.042316364147562735, 0.041700608312013776,
    0.0410891703805521, 0.040482056113888831, 0.039879271231998914,
    0.039280821414068023, 0.038686712298438841, 0.038096949482557207,
    0.037511538522920662, 0.0369304849350246, 0.03635379419331175,
    0.03578147173111984, 0.03521352294062996, 0.034649953172816828,
    0.03409076773739822, 0.033535971902783512, 0.032985570896025884,
    0.032439569902772247, 0.031897974067214008, 0.031360788492039493,
    0.030828018238385269, 0.030299668325788343, 0.029775743732139648,
    0.029256249393635969, 0.028741190204734646, 0.028230571018106776,
    0.027724396644591365, 0.027222671853150415, 0.026725401370824187,
    0.02623258988268562, 0.025744242031797371, 0.025260362419167626,
    0.024780955603706356, 0.024306026102182965, 0.023835578389183487,
    0.02336961689706829, 0.02290814601593083, 0.022451170093555295,
    0.021998693435376693, 0.021550720304439941, 0.021107254921359175,
    0.020668301464278838, 0.020233864068833873, 0.019803946828110375,
    0.019378553792608055, 0.018957688970200892, 0.018541356326100378,
    0.018129559782817606, 0.017722303220126134, 0.017319590475026181,
    0.016921425341707874, 0.016527811571515449, 0.016138752872912332,
    0.015754252911446, 0.015374315309713282, 0.014998943647326568,
    0.01462814146087954, 0.014261912243914543, 0.013900259446889329,
    0.013543186477144198, 0.013190696698870574, 0.012842793433078981,
    0.01249947995756745, 0.012160759506891217, 0.01182663527233202,
    0.011497110401867572, 0.011172188000142858, 0.010851871128439883,
    0.010536162804649529, 0.010225066003242966, 0.0099185836552431184,
    0.0096167186481979083, 0.0093194738261525578, 0.009026851989622442,
    0.0087388558955676654, 0.0084554882573663614, 0.0081767517447889349,
    0.0079026489839738034, 0.007633182557401752, 0.0073683550038720624,
    0.0071081688184786995, 0.00685262645258633, 0.0066017303138076189,
    0.00635548276598058, 0.006113886129145929, 0.0058769426795255431,
    0.00564465464950098, 0.0054170242275923264, 0.0051940535584377168,
    0.0049757447427728474, 0.0047620998374117152, 0.0045531208552267444,
    0.0043488097651298574, 0.0041491684920542671, 0.0039541989169362135,
    0.0037639028766968119, 0.0035782821642254548, 0.0033973385283623814,
    0.003221073673882302, 0.0030494892614786884, 0.0028825869077476196,
    0.00272036818517285, 0.0025628346221110432, 0.0024099877027770056,
    0.0022618288672302533, 0.0021183595113609677, 0.0019795809868770609,
    0.0018454946012914086, 0.0017161016179095823, 0.0015914032558178026,
    0.0014714006898715604, 0.0013560950506845693, 0.001245487424618108,
    0.0011395788537706397, 0.0010383703359682084, 0.00094186282475483551,
    0.0008500572293838049, 0.00076295441480872528, 0.00068055520167575878,
    0.00060286036631551632, 0.00052987064073617418, 0.00046158671261614659,
    0.00039800922529786842, 0.0003391387777817445, 0.00028497592472032096,
    0.00023552117641323367, 0.0001907749988023788, 0.00015073781346730541,
    0.0001154099976216072, 8.4791884109036708E-5, 5.8883761400674306E-5,
    3.768587359187503E-5, 2.11984204002702E-5, 9.421557163713512E-6,
    2.3553948388377322E-6, 0.0 };

  double varargin_1[1024];
  boolean_T exitg1;
  emxInit_real_T(&X, 2);
  ixstart = X0->size[0] * X0->size[1];
  jA2 = X->size[0] * X->size[1];
  X->size[0] = 1;
  X->size[1] = ixstart;
  emxEnsureCapacity((emxArray__common *)X, jA2, (int)sizeof(double));
  for (jA2 = 0; jA2 < ixstart; jA2++) {
    X->data[X->size[0] * jA2] = X0->data[jA2];
  }

  emxInit_real_T(&convconv, 2);

  // %Convolution Amplification:
  //  f_new=9:0.1:17;
  //  Clusters:
  // 5000, 2500, great, but slow. 2000 is quite fast
  jA2 = convconv->size[0] * convconv->size[1];
  convconv->size[0] = 28;
  convconv->size[1] = (int)(((double)X->size[1] + 2000.0) - 1.0);
  emxEnsureCapacity((emxArray__common *)convconv, jA2, (int)sizeof(double));
  ixstart = 28 * (int)(((double)X->size[1] + 2000.0) - 1.0);
  for (jA2 = 0; jA2 < ixstart; jA2++) {
    convconv->data[jA2] = 0.0;
  }

  for (i = 0; i < 28; i++) {
    // testSignal For generating idealized SSVEP Signals (Fourier Series)
    //    freq = frequency of signal waveform
    //    Fs = Sampling Frequency
    // %% Outputs:
    //  Y = Fundamental Frequency
    //  T = time singal
    //  Y1 = first harmonic
    //  Y2 = second harmonic
    //  SQW = square wave
    // standard sampling freq
    // Time Signal With Specified Frequency
    s = 6.2831853071795862 * dv3[i];
    for (jA2 = 0; jA2 < 2000; jA2++) {
      b[jA2] = s * b_b[jA2];
    }

    c_sin(b);
    s = 12.566370614359172 * dv3[i];
    for (jA2 = 0; jA2 < 2000; jA2++) {
      a[jA2] = s * b_b[jA2];
    }

    b_sin(a, unusedExpr);
    s = 18.849555921538759 * dv3[i];
    for (jA2 = 0; jA2 < 2000; jA2++) {
      a[jA2] = s * b_b[jA2];
    }

    b_sin(a, b_unusedExpr);

    //  SQW = amplitude*square(2*pi*freq*T);
    //  SQW = SQW(:);
    for (jA2 = 0; jA2 < 2000; jA2++) {
      sigs[i + 28 * jA2] = 0.0001 * b[jA2];
    }
  }

  emxInit_real_T(&r2, 2);
  emxInit_real_T(&b_convconv, 2);
  for (i = 0; i < 28; i++) {
    nA = X->size[1];
    if (X->size[1] == 0) {
      nC = 2000;
    } else {
      nC = X->size[1] + 1999;
    }

    jA2 = r2->size[0] * r2->size[1];
    r2->size[0] = 1;
    r2->size[1] = nC;
    emxEnsureCapacity((emxArray__common *)r2, jA2, (int)sizeof(double));
    if ((X->size[1] == 0) || (nC == 0)) {
      jA2 = r2->size[0] * r2->size[1];
      r2->size[0] = 1;
      emxEnsureCapacity((emxArray__common *)r2, jA2, (int)sizeof(double));
      ixstart = r2->size[1];
      for (jA2 = 0; jA2 < ixstart; jA2++) {
        r2->data[r2->size[0] * jA2] = 0.0;
      }
    } else {
      for (ixstart = 1; ixstart <= nC; ixstart++) {
        if (nA <= ixstart) {
          jA2 = nA;
        } else {
          jA2 = ixstart;
        }

        s = 0.0;
        if (2000 < ixstart + 1) {
          k = ixstart - 1999;
        } else {
          k = 1;
        }

        while (k <= jA2) {
          s += X->data[k - 1] * sigs[i + 28 * (ixstart - k)];
          k++;
        }

        r2->data[ixstart - 1] = s;
      }
    }

    ixstart = r2->size[1];
    for (jA2 = 0; jA2 < ixstart; jA2++) {
      convconv->data[i + convconv->size[0] * jA2] = r2->data[r2->size[0] * jA2];
    }

    ixstart = convconv->size[1];
    jA2 = b_convconv->size[0] * b_convconv->size[1];
    b_convconv->size[0] = 1;
    b_convconv->size[1] = ixstart;
    emxEnsureCapacity((emxArray__common *)b_convconv, jA2, (int)sizeof(double));
    for (jA2 = 0; jA2 < ixstart; jA2++) {
      b_convconv->data[b_convconv->size[0] * jA2] = convconv->data[i +
        convconv->size[0] * jA2];
    }

    welch_psd(b_convconv, 250.0, dv4, varargin_1, wfreqs);
    ixstart = 1;
    s = varargin_1[0];
    jA2 = 1;
    if (rtIsNaN(varargin_1[0])) {
      k = 2;
      exitg1 = false;
      while ((!exitg1) && (k < 1025)) {
        ixstart = k;
        if (!rtIsNaN(varargin_1[k - 1])) {
          s = varargin_1[k - 1];
          jA2 = k;
          exitg1 = true;
        } else {
          k++;
        }
      }
    }

    if (ixstart < 1024) {
      while (ixstart + 1 < 1025) {
        if (varargin_1[ixstart] > s) {
          s = varargin_1[ixstart];
          jA2 = ixstart + 1;
        }

        ixstart++;
      }
    }

    Mconv[i] = s;
    Lconv[i] = (short)jA2;
  }

  emxFree_real_T(&b_convconv);
  emxFree_real_T(&r2);
  emxFree_real_T(&convconv);
  emxFree_real_T(&X);

  //  Fts:
  for (jA2 = 0; jA2 < 28; jA2++) {
    P[jA2] = wfreqs[Lconv[jA2] - 1];
    P[jA2 + 28] = Mconv[jA2];
  }
}

//
// Arguments    : const emxArray_real_T *x
//                const double zi[6]
//                emxArray_real_T *y
// Return Type  : void
//
static void filter(const emxArray_real_T *x, const double zi[6], emxArray_real_T
                   *y)
{
  unsigned int unnamed_idx_0;
  int k;
  double dbuffer[7];
  int j;
  double b_dbuffer;
  static const double dv1[7] = { 0.00259188624245653, 0.0, -0.00777565872736959,
    0.0, 0.00777565872736959, 0.0, -0.00259188624245653 };

  static const double dv2[7] = { 1.0, -5.12636114248572, 11.2013241099204,
    -13.3475825890437, 9.14852464832994, -3.42093110978683, 0.54578683446378 };

  unnamed_idx_0 = (unsigned int)x->size[0];
  k = y->size[0];
  y->size[0] = (int)unnamed_idx_0;
  emxEnsureCapacity((emxArray__common *)y, k, (int)sizeof(double));
  for (k = 0; k < 6; k++) {
    dbuffer[k + 1] = zi[k];
  }

  for (j = 0; j + 1 <= x->size[0]; j++) {
    for (k = 0; k < 6; k++) {
      dbuffer[k] = dbuffer[k + 1];
    }

    dbuffer[6] = 0.0;
    for (k = 0; k < 7; k++) {
      b_dbuffer = dbuffer[k] + x->data[j] * dv1[k];
      dbuffer[k] = b_dbuffer;
    }

    for (k = 0; k < 6; k++) {
      dbuffer[k + 1] -= dbuffer[0] * dv2[k + 1];
    }

    y->data[j] = dbuffer[0];
  }
}

//
// [8 20] bandpass butterworth N=3
// Arguments    : emxArray_real_T *X
//                emxArray_real_T *Y
// Return Type  : void
//
static void ssvepcfilt(emxArray_real_T *X, emxArray_real_T *Y)
{
  int m;
  int i;
  emxArray_real_T *x;
  emxArray_real_T *y;
  double xtmp;
  double d0;
  int md2;
  double a[6];
  emxArray_real_T *b_y;
  static const double b_a[6] = { -0.0025918862424588094, -0.0025918862424471247,
    0.0051837724848969383, 0.0051837724849273592, -0.0025918862424630829,
    -0.0025918862424552862 };

  emxArray_real_T *c_y;
  emxArray_int32_T *r1;
  m = X->size[0];
  i = X->size[0];
  X->size[0] = m;
  emxEnsureCapacity((emxArray__common *)X, i, (int)sizeof(double));
  emxInit_real_T1(&x, 1);
  if (X->size[0] == 1) {
    i = x->size[0];
    x->size[0] = 1;
    emxEnsureCapacity((emxArray__common *)x, i, (int)sizeof(double));
    x->data[0] = X->data[0];
  } else {
    i = x->size[0];
    x->size[0] = X->size[0];
    emxEnsureCapacity((emxArray__common *)x, i, (int)sizeof(double));
    m = X->size[0];
    for (i = 0; i < m; i++) {
      x->data[i] = X->data[i];
    }
  }

  if (x->size[0] == 0) {
    i = Y->size[0] * Y->size[1];
    Y->size[0] = 0;
    Y->size[1] = 0;
    emxEnsureCapacity((emxArray__common *)Y, i, (int)sizeof(double));
  } else {
    emxInit_real_T1(&y, 1);
    xtmp = 2.0 * x->data[0];
    d0 = 2.0 * x->data[x->size[0] - 1];
    md2 = x->size[0] - 2;
    i = y->size[0];
    y->size[0] = 36 + x->size[0];
    emxEnsureCapacity((emxArray__common *)y, i, (int)sizeof(double));
    for (i = 0; i < 18; i++) {
      y->data[i] = xtmp - x->data[18 - i];
    }

    m = x->size[0];
    for (i = 0; i < m; i++) {
      y->data[i + 18] = x->data[i];
    }

    for (i = 0; i < 18; i++) {
      y->data[(i + x->size[0]) + 18] = d0 - x->data[md2 - i];
    }

    xtmp = y->data[0];
    for (i = 0; i < 6; i++) {
      a[i] = b_a[i] * xtmp;
    }

    emxInit_real_T1(&b_y, 1);
    i = b_y->size[0];
    b_y->size[0] = y->size[0];
    emxEnsureCapacity((emxArray__common *)b_y, i, (int)sizeof(double));
    m = y->size[0];
    for (i = 0; i < m; i++) {
      b_y->data[i] = y->data[i];
    }

    filter(b_y, a, y);
    m = y->size[0];
    md2 = y->size[0] >> 1;
    i = 1;
    emxFree_real_T(&b_y);
    while (i <= md2) {
      xtmp = y->data[i - 1];
      y->data[i - 1] = y->data[m - i];
      y->data[m - i] = xtmp;
      i++;
    }

    xtmp = y->data[0];
    for (i = 0; i < 6; i++) {
      a[i] = b_a[i] * xtmp;
    }

    emxInit_real_T1(&c_y, 1);
    i = c_y->size[0];
    c_y->size[0] = y->size[0];
    emxEnsureCapacity((emxArray__common *)c_y, i, (int)sizeof(double));
    m = y->size[0];
    for (i = 0; i < m; i++) {
      c_y->data[i] = y->data[i];
    }

    filter(c_y, a, y);
    m = y->size[0];
    md2 = y->size[0] >> 1;
    i = 1;
    emxFree_real_T(&c_y);
    while (i <= md2) {
      xtmp = y->data[i - 1];
      y->data[i - 1] = y->data[m - i];
      y->data[m - i] = xtmp;
      i++;
    }

    if (X->size[0] == 1) {
      m = x->size[0] - 1;
      i = Y->size[0] * Y->size[1];
      Y->size[0] = 1;
      Y->size[1] = m + 1;
      emxEnsureCapacity((emxArray__common *)Y, i, (int)sizeof(double));
      for (i = 0; i <= m; i++) {
        Y->data[Y->size[0] * i] = y->data[18 + i];
      }
    } else {
      emxInit_int32_T1(&r1, 1);
      m = x->size[0];
      i = Y->size[0] * Y->size[1];
      Y->size[0] = m;
      Y->size[1] = 1;
      emxEnsureCapacity((emxArray__common *)Y, i, (int)sizeof(double));
      i = r1->size[0];
      r1->size[0] = m;
      emxEnsureCapacity((emxArray__common *)r1, i, (int)sizeof(int));
      for (i = 0; i < m; i++) {
        r1->data[i] = 19 + i;
      }

      for (i = 0; i < m; i++) {
        Y->data[i] = y->data[r1->data[i] - 1];
      }

      emxFree_int32_T(&r1);
    }

    emxFree_real_T(&y);
  }

  emxFree_real_T(&x);
}

//
// if size(signals,2) > size(signals,1)
//      signals = signals.';
//  end
// Arguments    : const emxArray_real_T *signals
//                double fs
//                const double window[2048]
//                double CSM[1024]
//                double frequencies[1024]
// Return Type  : void
//
static void welch_psd(const emxArray_real_T *signals, double fs, const double
                      window[2048], double CSM[1024], double frequencies[1024])
{
  int iy;
  int number_of_blocks;
  double data_taper[2048];
  double S[1024];
  int a;
  int k;
  double Data_Block[2048];
  double twid_re;
  int b_k;
  int c_k;
  creal_T b_Data_Block[2048];
  int ix;
  int ju;
  int i;
  boolean_T tst;
  double temp_re;
  double temp_im;
  int istart;
  int j;
  static const double dv5[1025] = { 1.0, 0.99999529380957619,
    0.99998117528260111, 0.9999576445519639, 0.9999247018391445,
    0.99988234745421256, 0.9998305817958234, 0.99976940535121528,
    0.99969881869620425, 0.99961882249517864, 0.99952941750109314,
    0.99943060455546173, 0.99932238458834954, 0.99920475861836389,
    0.99907772775264536, 0.99894129318685687, 0.99879545620517241,
    0.99864021818026527, 0.99847558057329477, 0.99830154493389289,
    0.99811811290014918, 0.997925286198596, 0.99772306664419164,
    0.99751145614030345, 0.99729045667869021, 0.997060070339483,
    0.99682029929116567, 0.99657114579055484, 0.996312612182778,
    0.996044700901252, 0.99576741446765982, 0.99548075549192694,
    0.99518472667219693, 0.99487933079480562, 0.99456457073425542,
    0.9942404494531879, 0.99390697000235606, 0.9935641355205953,
    0.9932119492347945, 0.9928504144598651, 0.99247953459871, 0.9920993131421918,
    0.99170975366909953, 0.99131085984611544, 0.99090263542778,
    0.99048508425645709, 0.99005821026229712, 0.98962201746320089,
    0.989176509964781, 0.98872169196032378, 0.98825756773074946,
    0.98778414164457218, 0.98730141815785843, 0.98680940181418553,
    0.98630809724459867, 0.98579750916756748, 0.98527764238894122,
    0.98474850180190421, 0.984210092386929, 0.98366241921173025,
    0.98310548743121629, 0.98253930228744124, 0.98196386910955524,
    0.98137919331375456, 0.98078528040323043, 0.98018213596811743,
    0.97956976568544052, 0.9789481753190622, 0.97831737071962765,
    0.97767735782450993, 0.97702814265775439, 0.97636973133002114,
    0.97570213003852857, 0.97502534506699412, 0.97433938278557586,
    0.973644249650812, 0.97293995220556018, 0.97222649707893627,
    0.97150389098625178, 0.97077214072895035, 0.970031253194544,
    0.96928123535654853, 0.96852209427441727, 0.96775383709347551,
    0.96697647104485207, 0.9661900034454125, 0.9653944416976894,
    0.96458979328981276, 0.96377606579543984, 0.96295326687368388,
    0.96212140426904158, 0.96128048581132064, 0.96043051941556579,
    0.95957151308198452, 0.9587034748958716, 0.95782641302753291,
    0.95694033573220882, 0.95604525134999641, 0.95514116830577078,
    0.95422809510910567, 0.95330604035419386, 0.95237501271976588,
    0.95143502096900834, 0.9504860739494817, 0.94952818059303667,
    0.94856134991573027, 0.94758559101774109, 0.94660091308328353,
    0.94560732538052128, 0.94460483726148026, 0.94359345816196039,
    0.94257319760144687, 0.94154406518302081, 0.9405060705932683,
    0.93945922360218992, 0.93840353406310806, 0.937339011912575,
    0.93626566717027826, 0.93518350993894761, 0.93409255040425887,
    0.932992798834739, 0.93188426558166815, 0.93076696107898371,
    0.92964089584318121, 0.92850608047321559, 0.92736252565040111,
    0.92621024213831138, 0.92504924078267758, 0.92387953251128674,
    0.92270112833387863, 0.9215140393420419, 0.92031827670911059,
    0.91911385169005777, 0.9179007756213905, 0.9166790599210427,
    0.91544871608826783, 0.91420975570353069, 0.91296219042839821,
    0.91170603200542988, 0.91044129225806725, 0.90916798309052238,
    0.90788611648766626, 0.90659570451491533, 0.90529675931811882,
    0.90398929312344334, 0.90267331823725883, 0.901348847046022,
    0.90001589201616017, 0.89867446569395382, 0.89732458070541832,
    0.89596624975618522, 0.8945994856313827, 0.89322430119551532,
    0.89184070939234272, 0.89044872324475788, 0.88904835585466457,
    0.88763962040285393, 0.88622253014888064, 0.88479709843093779,
    0.88336333866573158, 0.881921264348355, 0.88047088905216075,
    0.87901222642863353, 0.87754529020726135, 0.8760700941954066,
    0.87458665227817611, 0.87309497841829009, 0.87159508665595109,
    0.87008699110871146, 0.8685707059713409, 0.86704624551569265,
    0.86551362409056909, 0.8639728561215867, 0.8624239561110405,
    0.86086693863776731, 0.85930181835700847, 0.85772861000027212,
    0.85614732837519447, 0.85455798836540053, 0.85296060493036363,
    0.8513551931052652, 0.84974176800085255, 0.84812034480329723,
    0.84649093877405213, 0.84485356524970712, 0.84320823964184544,
    0.84155497743689844, 0.83989379419599952, 0.83822470555483808,
    0.836547727223512, 0.83486287498638, 0.83317016470191319,
    0.83146961230254524, 0.829761233794523, 0.8280450452577558,
    0.82632106284566353, 0.82458930278502529, 0.82284978137582643,
    0.82110251499110465, 0.819347520076797, 0.81758481315158371,
    0.81581441080673378, 0.81403632970594841, 0.81225058658520388,
    0.81045719825259477, 0.808656181588175, 0.80684755354379933,
    0.80503133114296366, 0.80320753148064494, 0.80137617172314024,
    0.799537269107905, 0.79769084094339116, 0.79583690460888357,
    0.79397547755433717, 0.79210657730021239, 0.79023022143731,
    0.78834642762660634, 0.78645521359908577, 0.78455659715557524,
    0.78265059616657573, 0.78073722857209449, 0.778816512381476,
    0.77688846567323244, 0.77495310659487393, 0.773010453362737,
    0.77106052426181382, 0.7691033376455797, 0.7671389119358204,
    0.765167265622459, 0.76318841726338127, 0.76120238548426178,
    0.759209188978388, 0.75720884650648457, 0.75520137689653655,
    0.75318679904361252, 0.75116513190968637, 0.74913639452345937,
    0.74710060598018013, 0.745057785441466, 0.74300795213512172,
    0.74095112535495922, 0.73888732446061511, 0.73681656887736979,
    0.7347388780959635, 0.73265427167241282, 0.73056276922782759,
    0.7284643904482252, 0.726359155084346, 0.724247082951467,
    0.72212819392921535, 0.72000250796138165, 0.71787004505573171,
    0.71573082528381859, 0.71358486878079352, 0.71143219574521643,
    0.70927282643886569, 0.70710678118654757, 0.70493408037590488,
    0.7027547444572253, 0.70056879394324834, 0.69837624940897292,
    0.696177131491463, 0.69397146088965389, 0.69175925836415775,
    0.68954054473706683, 0.687315340891759, 0.68508366777270036,
    0.68284554638524808, 0.680600997795453, 0.67835004312986147,
    0.67609270357531592, 0.673829000378756, 0.67155895484701833,
    0.669282588346636, 0.66699992230363747, 0.66471097820334479,
    0.66241577759017178, 0.66011434206742048, 0.65780669329707864,
    0.65549285299961535, 0.65317284295377676, 0.650846684996381,
    0.64851440102211244, 0.64617601298331628, 0.64383154288979139,
    0.641481012808583, 0.63912444486377573, 0.6367618612362842,
    0.63439328416364549, 0.63201873593980906, 0.629638238914927,
    0.62725181549514408, 0.62485948814238634, 0.62246127937415,
    0.6200572117632891, 0.61764730793780387, 0.61523159058062682,
    0.61281008242940971, 0.61038280627630948, 0.60794978496777363,
    0.60551104140432555, 0.60306659854034816, 0.600616479383869,
    0.59816070699634238, 0.59569930449243336, 0.5932322950397998,
    0.59075970185887416, 0.58828154822264522, 0.58579785745643886,
    0.58330865293769829, 0.58081395809576453, 0.57831379641165559,
    0.57580819141784534, 0.5732971666980422, 0.57078074588696726,
    0.56825895267013149, 0.56573181078361312, 0.56319934401383409,
    0.560661576197336, 0.5581185312205561, 0.55557023301960218,
    0.55301670558002747, 0.55045797293660481, 0.54789405917310019,
    0.54532498842204646, 0.54275078486451589, 0.54017147272989285,
    0.53758707629564539, 0.53499761988709715, 0.5324031278771979,
    0.52980362468629461, 0.52719913478190128, 0.524589682678469,
    0.52197529293715439, 0.51935599016558964, 0.51673179901764987,
    0.51410274419322166, 0.5114688504379703, 0.508830142543107,
    0.50618664534515523, 0.50353838372571758, 0.50088538261124071,
    0.49822766697278181, 0.49556526182577254, 0.49289819222978404,
    0.49022648328829116, 0.487550160148436, 0.48486924800079106,
    0.48218377207912272, 0.47949375766015295, 0.47679923006332209,
    0.47410021465054997, 0.47139673682599764, 0.46868882203582796,
    0.46597649576796618, 0.46325978355186015, 0.46053871095824,
    0.45781330359887717, 0.45508358712634384, 0.45234958723377089,
    0.44961132965460654, 0.44686884016237416, 0.4441221445704292,
    0.44137126873171667, 0.43861623853852766, 0.43585707992225547,
    0.43309381885315196, 0.43032648134008261, 0.42755509343028208,
    0.42477968120910881, 0.42200027079979968, 0.41921688836322391,
    0.41642956009763715, 0.4136383122384345, 0.41084317105790391,
    0.40804416286497869, 0.40524131400498986, 0.40243465085941843,
    0.39962419984564679, 0.39680998741671031, 0.3939920400610481,
    0.39117038430225387, 0.38834504669882625, 0.38551605384391885,
    0.38268343236508978, 0.37984720892405116, 0.37700741021641826,
    0.37416406297145793, 0.37131719395183749, 0.36846682995337232,
    0.36561299780477385, 0.36275572436739723, 0.35989503653498811,
    0.35703096123343, 0.35416352542049034, 0.35129275608556709,
    0.34841868024943456, 0.34554132496398909, 0.34266071731199438,
    0.33977688440682685, 0.33688985339222005, 0.33399965144200938,
    0.33110630575987643, 0.3282098435790925, 0.32531029216226293,
    0.32240767880106985, 0.31950203081601569, 0.31659337555616585,
    0.31368174039889152, 0.31076715274961147, 0.30784964004153487,
    0.30492922973540237, 0.30200594931922808, 0.29907982630804048,
    0.29615088824362379, 0.29321916269425863, 0.29028467725446233,
    0.28734745954472951, 0.28440753721127188, 0.28146493792575794,
    0.27851968938505306, 0.27557181931095814, 0.272621355449949,
    0.26966832557291509, 0.26671275747489837, 0.26375467897483135,
    0.26079411791527551, 0.257831102162159, 0.25486565960451457,
    0.25189781815421697, 0.24892760574572015, 0.24595505033579459,
    0.24298017990326387, 0.2400030224487415, 0.2370236059943672,
    0.23404195858354343, 0.23105810828067111, 0.22807208317088573,
    0.22508391135979283, 0.22209362097320351, 0.2191012401568698,
    0.21610679707621952, 0.21311031991609136, 0.21011183688046961,
    0.20711137619221856, 0.20410896609281687, 0.2011046348420919,
    0.19809841071795356, 0.19509032201612825, 0.19208039704989244,
    0.18906866414980619, 0.18605515166344663, 0.18303988795514095,
    0.18002290140569951, 0.17700422041214875, 0.17398387338746382,
    0.17096188876030122, 0.16793829497473117, 0.16491312048996992,
    0.16188639378011183, 0.15885814333386145, 0.15582839765426523,
    0.15279718525844344, 0.14976453467732151, 0.14673047445536175,
    0.14369503315029447, 0.14065823933284921, 0.13762012158648604,
    0.13458070850712617, 0.13154002870288312, 0.12849811079379317,
    0.12545498341154623, 0.1224106751992162, 0.11936521481099135,
    0.11631863091190475, 0.11327095217756435, 0.11022220729388306,
    0.10717242495680884, 0.10412163387205459, 0.10106986275482782,
    0.0980171403295606, 0.094963495329638992, 0.091908956497132724,
    0.0888535525825246, 0.0857973123444399, 0.082740264549375692,
    0.079682437971430126, 0.076623861392031492, 0.073564563599667426,
    0.070504573389613856, 0.067443919563664051, 0.064382630929857465,
    0.061320736302208578, 0.058258264500435752, 0.055195244349689941,
    0.052131704680283324, 0.049067674327418015, 0.046003182130914623,
    0.04293825693494082, 0.039872927587739811, 0.036807222941358832,
    0.03374117185137758, 0.030674803176636626, 0.02760814577896574,
    0.024541228522912288, 0.021474080275469508, 0.01840672990580482,
    0.0153392062849881, 0.012271538285719925, 0.00920375478205982,
    0.0061358846491544753, 0.0030679567629659761, 0.0, -0.0030679567629659761,
    -0.0061358846491544753, -0.00920375478205982, -0.012271538285719925,
    -0.0153392062849881, -0.01840672990580482, -0.021474080275469508,
    -0.024541228522912288, -0.02760814577896574, -0.030674803176636626,
    -0.03374117185137758, -0.036807222941358832, -0.039872927587739811,
    -0.04293825693494082, -0.046003182130914623, -0.049067674327418015,
    -0.052131704680283324, -0.055195244349689941, -0.058258264500435752,
    -0.061320736302208578, -0.064382630929857465, -0.067443919563664051,
    -0.070504573389613856, -0.073564563599667426, -0.076623861392031492,
    -0.079682437971430126, -0.082740264549375692, -0.0857973123444399,
    -0.0888535525825246, -0.091908956497132724, -0.094963495329638992,
    -0.0980171403295606, -0.10106986275482782, -0.10412163387205459,
    -0.10717242495680884, -0.11022220729388306, -0.11327095217756435,
    -0.11631863091190475, -0.11936521481099135, -0.1224106751992162,
    -0.12545498341154623, -0.12849811079379317, -0.13154002870288312,
    -0.13458070850712617, -0.13762012158648604, -0.14065823933284921,
    -0.14369503315029447, -0.14673047445536175, -0.14976453467732151,
    -0.15279718525844344, -0.15582839765426523, -0.15885814333386145,
    -0.16188639378011183, -0.16491312048996992, -0.16793829497473117,
    -0.17096188876030122, -0.17398387338746382, -0.17700422041214875,
    -0.18002290140569951, -0.18303988795514095, -0.18605515166344663,
    -0.18906866414980619, -0.19208039704989244, -0.19509032201612825,
    -0.19809841071795356, -0.2011046348420919, -0.20410896609281687,
    -0.20711137619221856, -0.21011183688046961, -0.21311031991609136,
    -0.21610679707621952, -0.2191012401568698, -0.22209362097320351,
    -0.22508391135979283, -0.22807208317088573, -0.23105810828067111,
    -0.23404195858354343, -0.2370236059943672, -0.2400030224487415,
    -0.24298017990326387, -0.24595505033579459, -0.24892760574572015,
    -0.25189781815421697, -0.25486565960451457, -0.257831102162159,
    -0.26079411791527551, -0.26375467897483135, -0.26671275747489837,
    -0.26966832557291509, -0.272621355449949, -0.27557181931095814,
    -0.27851968938505306, -0.28146493792575794, -0.28440753721127188,
    -0.28734745954472951, -0.29028467725446233, -0.29321916269425863,
    -0.29615088824362379, -0.29907982630804048, -0.30200594931922808,
    -0.30492922973540237, -0.30784964004153487, -0.31076715274961147,
    -0.31368174039889152, -0.31659337555616585, -0.31950203081601569,
    -0.32240767880106985, -0.32531029216226293, -0.3282098435790925,
    -0.33110630575987643, -0.33399965144200938, -0.33688985339222005,
    -0.33977688440682685, -0.34266071731199438, -0.34554132496398909,
    -0.34841868024943456, -0.35129275608556709, -0.35416352542049034,
    -0.35703096123343, -0.35989503653498811, -0.36275572436739723,
    -0.36561299780477385, -0.36846682995337232, -0.37131719395183749,
    -0.37416406297145793, -0.37700741021641826, -0.37984720892405116,
    -0.38268343236508978, -0.38551605384391885, -0.38834504669882625,
    -0.39117038430225387, -0.3939920400610481, -0.39680998741671031,
    -0.39962419984564679, -0.40243465085941843, -0.40524131400498986,
    -0.40804416286497869, -0.41084317105790391, -0.4136383122384345,
    -0.41642956009763715, -0.41921688836322391, -0.42200027079979968,
    -0.42477968120910881, -0.42755509343028208, -0.43032648134008261,
    -0.43309381885315196, -0.43585707992225547, -0.43861623853852766,
    -0.44137126873171667, -0.4441221445704292, -0.44686884016237416,
    -0.44961132965460654, -0.45234958723377089, -0.45508358712634384,
    -0.45781330359887717, -0.46053871095824, -0.46325978355186015,
    -0.46597649576796618, -0.46868882203582796, -0.47139673682599764,
    -0.47410021465054997, -0.47679923006332209, -0.47949375766015295,
    -0.48218377207912272, -0.48486924800079106, -0.487550160148436,
    -0.49022648328829116, -0.49289819222978404, -0.49556526182577254,
    -0.49822766697278181, -0.50088538261124071, -0.50353838372571758,
    -0.50618664534515523, -0.508830142543107, -0.5114688504379703,
    -0.51410274419322166, -0.51673179901764987, -0.51935599016558964,
    -0.52197529293715439, -0.524589682678469, -0.52719913478190128,
    -0.52980362468629461, -0.5324031278771979, -0.53499761988709715,
    -0.53758707629564539, -0.54017147272989285, -0.54275078486451589,
    -0.54532498842204646, -0.54789405917310019, -0.55045797293660481,
    -0.55301670558002747, -0.55557023301960218, -0.5581185312205561,
    -0.560661576197336, -0.56319934401383409, -0.56573181078361312,
    -0.56825895267013149, -0.57078074588696726, -0.5732971666980422,
    -0.57580819141784534, -0.57831379641165559, -0.58081395809576453,
    -0.58330865293769829, -0.58579785745643886, -0.58828154822264522,
    -0.59075970185887416, -0.5932322950397998, -0.59569930449243336,
    -0.59816070699634238, -0.600616479383869, -0.60306659854034816,
    -0.60551104140432555, -0.60794978496777363, -0.61038280627630948,
    -0.61281008242940971, -0.61523159058062682, -0.61764730793780387,
    -0.6200572117632891, -0.62246127937415, -0.62485948814238634,
    -0.62725181549514408, -0.629638238914927, -0.63201873593980906,
    -0.63439328416364549, -0.6367618612362842, -0.63912444486377573,
    -0.641481012808583, -0.64383154288979139, -0.64617601298331628,
    -0.64851440102211244, -0.650846684996381, -0.65317284295377676,
    -0.65549285299961535, -0.65780669329707864, -0.66011434206742048,
    -0.66241577759017178, -0.66471097820334479, -0.66699992230363747,
    -0.669282588346636, -0.67155895484701833, -0.673829000378756,
    -0.67609270357531592, -0.67835004312986147, -0.680600997795453,
    -0.68284554638524808, -0.68508366777270036, -0.687315340891759,
    -0.68954054473706683, -0.69175925836415775, -0.69397146088965389,
    -0.696177131491463, -0.69837624940897292, -0.70056879394324834,
    -0.7027547444572253, -0.70493408037590488, -0.70710678118654757,
    -0.70927282643886569, -0.71143219574521643, -0.71358486878079352,
    -0.71573082528381859, -0.71787004505573171, -0.72000250796138165,
    -0.72212819392921535, -0.724247082951467, -0.726359155084346,
    -0.7284643904482252, -0.73056276922782759, -0.73265427167241282,
    -0.7347388780959635, -0.73681656887736979, -0.73888732446061511,
    -0.74095112535495922, -0.74300795213512172, -0.745057785441466,
    -0.74710060598018013, -0.74913639452345937, -0.75116513190968637,
    -0.75318679904361252, -0.75520137689653655, -0.75720884650648457,
    -0.759209188978388, -0.76120238548426178, -0.76318841726338127,
    -0.765167265622459, -0.7671389119358204, -0.7691033376455797,
    -0.77106052426181382, -0.773010453362737, -0.77495310659487393,
    -0.77688846567323244, -0.778816512381476, -0.78073722857209449,
    -0.78265059616657573, -0.78455659715557524, -0.78645521359908577,
    -0.78834642762660634, -0.79023022143731, -0.79210657730021239,
    -0.79397547755433717, -0.79583690460888357, -0.79769084094339116,
    -0.799537269107905, -0.80137617172314024, -0.80320753148064494,
    -0.80503133114296366, -0.80684755354379933, -0.808656181588175,
    -0.81045719825259477, -0.81225058658520388, -0.81403632970594841,
    -0.81581441080673378, -0.81758481315158371, -0.819347520076797,
    -0.82110251499110465, -0.82284978137582643, -0.82458930278502529,
    -0.82632106284566353, -0.8280450452577558, -0.829761233794523,
    -0.83146961230254524, -0.83317016470191319, -0.83486287498638,
    -0.836547727223512, -0.83822470555483808, -0.83989379419599952,
    -0.84155497743689844, -0.84320823964184544, -0.84485356524970712,
    -0.84649093877405213, -0.84812034480329723, -0.84974176800085255,
    -0.8513551931052652, -0.85296060493036363, -0.85455798836540053,
    -0.85614732837519447, -0.85772861000027212, -0.85930181835700847,
    -0.86086693863776731, -0.8624239561110405, -0.8639728561215867,
    -0.86551362409056909, -0.86704624551569265, -0.8685707059713409,
    -0.87008699110871146, -0.87159508665595109, -0.87309497841829009,
    -0.87458665227817611, -0.8760700941954066, -0.87754529020726135,
    -0.87901222642863353, -0.88047088905216075, -0.881921264348355,
    -0.88336333866573158, -0.88479709843093779, -0.88622253014888064,
    -0.88763962040285393, -0.88904835585466457, -0.89044872324475788,
    -0.89184070939234272, -0.89322430119551532, -0.8945994856313827,
    -0.89596624975618522, -0.89732458070541832, -0.89867446569395382,
    -0.90001589201616017, -0.901348847046022, -0.90267331823725883,
    -0.90398929312344334, -0.90529675931811882, -0.90659570451491533,
    -0.90788611648766626, -0.90916798309052238, -0.91044129225806725,
    -0.91170603200542988, -0.91296219042839821, -0.91420975570353069,
    -0.91544871608826783, -0.9166790599210427, -0.9179007756213905,
    -0.91911385169005777, -0.92031827670911059, -0.9215140393420419,
    -0.92270112833387863, -0.92387953251128674, -0.92504924078267758,
    -0.92621024213831138, -0.92736252565040111, -0.92850608047321559,
    -0.92964089584318121, -0.93076696107898371, -0.93188426558166815,
    -0.932992798834739, -0.93409255040425887, -0.93518350993894761,
    -0.93626566717027826, -0.937339011912575, -0.93840353406310806,
    -0.93945922360218992, -0.9405060705932683, -0.94154406518302081,
    -0.94257319760144687, -0.94359345816196039, -0.94460483726148026,
    -0.94560732538052128, -0.94660091308328353, -0.94758559101774109,
    -0.94856134991573027, -0.94952818059303667, -0.9504860739494817,
    -0.95143502096900834, -0.95237501271976588, -0.95330604035419386,
    -0.95422809510910567, -0.95514116830577078, -0.95604525134999641,
    -0.95694033573220882, -0.95782641302753291, -0.9587034748958716,
    -0.95957151308198452, -0.96043051941556579, -0.96128048581132064,
    -0.96212140426904158, -0.96295326687368388, -0.96377606579543984,
    -0.96458979328981276, -0.9653944416976894, -0.9661900034454125,
    -0.96697647104485207, -0.96775383709347551, -0.96852209427441727,
    -0.96928123535654853, -0.970031253194544, -0.97077214072895035,
    -0.97150389098625178, -0.97222649707893627, -0.97293995220556018,
    -0.973644249650812, -0.97433938278557586, -0.97502534506699412,
    -0.97570213003852857, -0.97636973133002114, -0.97702814265775439,
    -0.97767735782450993, -0.97831737071962765, -0.9789481753190622,
    -0.97956976568544052, -0.98018213596811743, -0.98078528040323043,
    -0.98137919331375456, -0.98196386910955524, -0.98253930228744124,
    -0.98310548743121629, -0.98366241921173025, -0.984210092386929,
    -0.98474850180190421, -0.98527764238894122, -0.98579750916756748,
    -0.98630809724459867, -0.98680940181418553, -0.98730141815785843,
    -0.98778414164457218, -0.98825756773074946, -0.98872169196032378,
    -0.989176509964781, -0.98962201746320089, -0.99005821026229712,
    -0.99048508425645709, -0.99090263542778, -0.99131085984611544,
    -0.99170975366909953, -0.9920993131421918, -0.99247953459871,
    -0.9928504144598651, -0.9932119492347945, -0.9935641355205953,
    -0.99390697000235606, -0.9942404494531879, -0.99456457073425542,
    -0.99487933079480562, -0.99518472667219693, -0.99548075549192694,
    -0.99576741446765982, -0.996044700901252, -0.996312612182778,
    -0.99657114579055484, -0.99682029929116567, -0.997060070339483,
    -0.99729045667869021, -0.99751145614030345, -0.99772306664419164,
    -0.997925286198596, -0.99811811290014918, -0.99830154493389289,
    -0.99847558057329477, -0.99864021818026527, -0.99879545620517241,
    -0.99894129318685687, -0.99907772775264536, -0.99920475861836389,
    -0.99932238458834954, -0.99943060455546173, -0.99952941750109314,
    -0.99961882249517864, -0.99969881869620425, -0.99976940535121528,
    -0.9998305817958234, -0.99988234745421256, -0.9999247018391445,
    -0.9999576445519639, -0.99998117528260111, -0.99999529380957619, -1.0 };

  double twid_im;
  static const double dv6[1025] = { 0.0, -0.0030679567629659761,
    -0.0061358846491544753, -0.00920375478205982, -0.012271538285719925,
    -0.0153392062849881, -0.01840672990580482, -0.021474080275469508,
    -0.024541228522912288, -0.02760814577896574, -0.030674803176636626,
    -0.03374117185137758, -0.036807222941358832, -0.039872927587739811,
    -0.04293825693494082, -0.046003182130914623, -0.049067674327418015,
    -0.052131704680283324, -0.055195244349689941, -0.058258264500435752,
    -0.061320736302208578, -0.064382630929857465, -0.067443919563664051,
    -0.070504573389613856, -0.073564563599667426, -0.076623861392031492,
    -0.079682437971430126, -0.082740264549375692, -0.0857973123444399,
    -0.0888535525825246, -0.091908956497132724, -0.094963495329638992,
    -0.0980171403295606, -0.10106986275482782, -0.10412163387205459,
    -0.10717242495680884, -0.11022220729388306, -0.11327095217756435,
    -0.11631863091190475, -0.11936521481099135, -0.1224106751992162,
    -0.12545498341154623, -0.12849811079379317, -0.13154002870288312,
    -0.13458070850712617, -0.13762012158648604, -0.14065823933284921,
    -0.14369503315029447, -0.14673047445536175, -0.14976453467732151,
    -0.15279718525844344, -0.15582839765426523, -0.15885814333386145,
    -0.16188639378011183, -0.16491312048996992, -0.16793829497473117,
    -0.17096188876030122, -0.17398387338746382, -0.17700422041214875,
    -0.18002290140569951, -0.18303988795514095, -0.18605515166344663,
    -0.18906866414980619, -0.19208039704989244, -0.19509032201612825,
    -0.19809841071795356, -0.2011046348420919, -0.20410896609281687,
    -0.20711137619221856, -0.21011183688046961, -0.21311031991609136,
    -0.21610679707621952, -0.2191012401568698, -0.22209362097320351,
    -0.22508391135979283, -0.22807208317088573, -0.23105810828067111,
    -0.23404195858354343, -0.2370236059943672, -0.2400030224487415,
    -0.24298017990326387, -0.24595505033579459, -0.24892760574572015,
    -0.25189781815421697, -0.25486565960451457, -0.257831102162159,
    -0.26079411791527551, -0.26375467897483135, -0.26671275747489837,
    -0.26966832557291509, -0.272621355449949, -0.27557181931095814,
    -0.27851968938505306, -0.28146493792575794, -0.28440753721127188,
    -0.28734745954472951, -0.29028467725446233, -0.29321916269425863,
    -0.29615088824362379, -0.29907982630804048, -0.30200594931922808,
    -0.30492922973540237, -0.30784964004153487, -0.31076715274961147,
    -0.31368174039889152, -0.31659337555616585, -0.31950203081601569,
    -0.32240767880106985, -0.32531029216226293, -0.3282098435790925,
    -0.33110630575987643, -0.33399965144200938, -0.33688985339222005,
    -0.33977688440682685, -0.34266071731199438, -0.34554132496398909,
    -0.34841868024943456, -0.35129275608556709, -0.35416352542049034,
    -0.35703096123343, -0.35989503653498811, -0.36275572436739723,
    -0.36561299780477385, -0.36846682995337232, -0.37131719395183749,
    -0.37416406297145793, -0.37700741021641826, -0.37984720892405116,
    -0.38268343236508978, -0.38551605384391885, -0.38834504669882625,
    -0.39117038430225387, -0.3939920400610481, -0.39680998741671031,
    -0.39962419984564679, -0.40243465085941843, -0.40524131400498986,
    -0.40804416286497869, -0.41084317105790391, -0.4136383122384345,
    -0.41642956009763715, -0.41921688836322391, -0.42200027079979968,
    -0.42477968120910881, -0.42755509343028208, -0.43032648134008261,
    -0.43309381885315196, -0.43585707992225547, -0.43861623853852766,
    -0.44137126873171667, -0.4441221445704292, -0.44686884016237416,
    -0.44961132965460654, -0.45234958723377089, -0.45508358712634384,
    -0.45781330359887717, -0.46053871095824, -0.46325978355186015,
    -0.46597649576796618, -0.46868882203582796, -0.47139673682599764,
    -0.47410021465054997, -0.47679923006332209, -0.47949375766015295,
    -0.48218377207912272, -0.48486924800079106, -0.487550160148436,
    -0.49022648328829116, -0.49289819222978404, -0.49556526182577254,
    -0.49822766697278181, -0.50088538261124071, -0.50353838372571758,
    -0.50618664534515523, -0.508830142543107, -0.5114688504379703,
    -0.51410274419322166, -0.51673179901764987, -0.51935599016558964,
    -0.52197529293715439, -0.524589682678469, -0.52719913478190128,
    -0.52980362468629461, -0.5324031278771979, -0.53499761988709715,
    -0.53758707629564539, -0.54017147272989285, -0.54275078486451589,
    -0.54532498842204646, -0.54789405917310019, -0.55045797293660481,
    -0.55301670558002747, -0.55557023301960218, -0.5581185312205561,
    -0.560661576197336, -0.56319934401383409, -0.56573181078361312,
    -0.56825895267013149, -0.57078074588696726, -0.5732971666980422,
    -0.57580819141784534, -0.57831379641165559, -0.58081395809576453,
    -0.58330865293769829, -0.58579785745643886, -0.58828154822264522,
    -0.59075970185887416, -0.5932322950397998, -0.59569930449243336,
    -0.59816070699634238, -0.600616479383869, -0.60306659854034816,
    -0.60551104140432555, -0.60794978496777363, -0.61038280627630948,
    -0.61281008242940971, -0.61523159058062682, -0.61764730793780387,
    -0.6200572117632891, -0.62246127937415, -0.62485948814238634,
    -0.62725181549514408, -0.629638238914927, -0.63201873593980906,
    -0.63439328416364549, -0.6367618612362842, -0.63912444486377573,
    -0.641481012808583, -0.64383154288979139, -0.64617601298331628,
    -0.64851440102211244, -0.650846684996381, -0.65317284295377676,
    -0.65549285299961535, -0.65780669329707864, -0.66011434206742048,
    -0.66241577759017178, -0.66471097820334479, -0.66699992230363747,
    -0.669282588346636, -0.67155895484701833, -0.673829000378756,
    -0.67609270357531592, -0.67835004312986147, -0.680600997795453,
    -0.68284554638524808, -0.68508366777270036, -0.687315340891759,
    -0.68954054473706683, -0.69175925836415775, -0.69397146088965389,
    -0.696177131491463, -0.69837624940897292, -0.70056879394324834,
    -0.7027547444572253, -0.70493408037590488, -0.70710678118654757,
    -0.70927282643886569, -0.71143219574521643, -0.71358486878079352,
    -0.71573082528381859, -0.71787004505573171, -0.72000250796138165,
    -0.72212819392921535, -0.724247082951467, -0.726359155084346,
    -0.7284643904482252, -0.73056276922782759, -0.73265427167241282,
    -0.7347388780959635, -0.73681656887736979, -0.73888732446061511,
    -0.74095112535495922, -0.74300795213512172, -0.745057785441466,
    -0.74710060598018013, -0.74913639452345937, -0.75116513190968637,
    -0.75318679904361252, -0.75520137689653655, -0.75720884650648457,
    -0.759209188978388, -0.76120238548426178, -0.76318841726338127,
    -0.765167265622459, -0.7671389119358204, -0.7691033376455797,
    -0.77106052426181382, -0.773010453362737, -0.77495310659487393,
    -0.77688846567323244, -0.778816512381476, -0.78073722857209449,
    -0.78265059616657573, -0.78455659715557524, -0.78645521359908577,
    -0.78834642762660634, -0.79023022143731, -0.79210657730021239,
    -0.79397547755433717, -0.79583690460888357, -0.79769084094339116,
    -0.799537269107905, -0.80137617172314024, -0.80320753148064494,
    -0.80503133114296366, -0.80684755354379933, -0.808656181588175,
    -0.81045719825259477, -0.81225058658520388, -0.81403632970594841,
    -0.81581441080673378, -0.81758481315158371, -0.819347520076797,
    -0.82110251499110465, -0.82284978137582643, -0.82458930278502529,
    -0.82632106284566353, -0.8280450452577558, -0.829761233794523,
    -0.83146961230254524, -0.83317016470191319, -0.83486287498638,
    -0.836547727223512, -0.83822470555483808, -0.83989379419599952,
    -0.84155497743689844, -0.84320823964184544, -0.84485356524970712,
    -0.84649093877405213, -0.84812034480329723, -0.84974176800085255,
    -0.8513551931052652, -0.85296060493036363, -0.85455798836540053,
    -0.85614732837519447, -0.85772861000027212, -0.85930181835700847,
    -0.86086693863776731, -0.8624239561110405, -0.8639728561215867,
    -0.86551362409056909, -0.86704624551569265, -0.8685707059713409,
    -0.87008699110871146, -0.87159508665595109, -0.87309497841829009,
    -0.87458665227817611, -0.8760700941954066, -0.87754529020726135,
    -0.87901222642863353, -0.88047088905216075, -0.881921264348355,
    -0.88336333866573158, -0.88479709843093779, -0.88622253014888064,
    -0.88763962040285393, -0.88904835585466457, -0.89044872324475788,
    -0.89184070939234272, -0.89322430119551532, -0.8945994856313827,
    -0.89596624975618522, -0.89732458070541832, -0.89867446569395382,
    -0.90001589201616017, -0.901348847046022, -0.90267331823725883,
    -0.90398929312344334, -0.90529675931811882, -0.90659570451491533,
    -0.90788611648766626, -0.90916798309052238, -0.91044129225806725,
    -0.91170603200542988, -0.91296219042839821, -0.91420975570353069,
    -0.91544871608826783, -0.9166790599210427, -0.9179007756213905,
    -0.91911385169005777, -0.92031827670911059, -0.9215140393420419,
    -0.92270112833387863, -0.92387953251128674, -0.92504924078267758,
    -0.92621024213831138, -0.92736252565040111, -0.92850608047321559,
    -0.92964089584318121, -0.93076696107898371, -0.93188426558166815,
    -0.932992798834739, -0.93409255040425887, -0.93518350993894761,
    -0.93626566717027826, -0.937339011912575, -0.93840353406310806,
    -0.93945922360218992, -0.9405060705932683, -0.94154406518302081,
    -0.94257319760144687, -0.94359345816196039, -0.94460483726148026,
    -0.94560732538052128, -0.94660091308328353, -0.94758559101774109,
    -0.94856134991573027, -0.94952818059303667, -0.9504860739494817,
    -0.95143502096900834, -0.95237501271976588, -0.95330604035419386,
    -0.95422809510910567, -0.95514116830577078, -0.95604525134999641,
    -0.95694033573220882, -0.95782641302753291, -0.9587034748958716,
    -0.95957151308198452, -0.96043051941556579, -0.96128048581132064,
    -0.96212140426904158, -0.96295326687368388, -0.96377606579543984,
    -0.96458979328981276, -0.9653944416976894, -0.9661900034454125,
    -0.96697647104485207, -0.96775383709347551, -0.96852209427441727,
    -0.96928123535654853, -0.970031253194544, -0.97077214072895035,
    -0.97150389098625178, -0.97222649707893627, -0.97293995220556018,
    -0.973644249650812, -0.97433938278557586, -0.97502534506699412,
    -0.97570213003852857, -0.97636973133002114, -0.97702814265775439,
    -0.97767735782450993, -0.97831737071962765, -0.9789481753190622,
    -0.97956976568544052, -0.98018213596811743, -0.98078528040323043,
    -0.98137919331375456, -0.98196386910955524, -0.98253930228744124,
    -0.98310548743121629, -0.98366241921173025, -0.984210092386929,
    -0.98474850180190421, -0.98527764238894122, -0.98579750916756748,
    -0.98630809724459867, -0.98680940181418553, -0.98730141815785843,
    -0.98778414164457218, -0.98825756773074946, -0.98872169196032378,
    -0.989176509964781, -0.98962201746320089, -0.99005821026229712,
    -0.99048508425645709, -0.99090263542778, -0.99131085984611544,
    -0.99170975366909953, -0.9920993131421918, -0.99247953459871,
    -0.9928504144598651, -0.9932119492347945, -0.9935641355205953,
    -0.99390697000235606, -0.9942404494531879, -0.99456457073425542,
    -0.99487933079480562, -0.99518472667219693, -0.99548075549192694,
    -0.99576741446765982, -0.996044700901252, -0.996312612182778,
    -0.99657114579055484, -0.99682029929116567, -0.997060070339483,
    -0.99729045667869021, -0.99751145614030345, -0.99772306664419164,
    -0.997925286198596, -0.99811811290014918, -0.99830154493389289,
    -0.99847558057329477, -0.99864021818026527, -0.99879545620517241,
    -0.99894129318685687, -0.99907772775264536, -0.99920475861836389,
    -0.99932238458834954, -0.99943060455546173, -0.99952941750109314,
    -0.99961882249517864, -0.99969881869620425, -0.99976940535121528,
    -0.9998305817958234, -0.99988234745421256, -0.9999247018391445,
    -0.9999576445519639, -0.99998117528260111, -0.99999529380957619, -1.0,
    -0.99999529380957619, -0.99998117528260111, -0.9999576445519639,
    -0.9999247018391445, -0.99988234745421256, -0.9998305817958234,
    -0.99976940535121528, -0.99969881869620425, -0.99961882249517864,
    -0.99952941750109314, -0.99943060455546173, -0.99932238458834954,
    -0.99920475861836389, -0.99907772775264536, -0.99894129318685687,
    -0.99879545620517241, -0.99864021818026527, -0.99847558057329477,
    -0.99830154493389289, -0.99811811290014918, -0.997925286198596,
    -0.99772306664419164, -0.99751145614030345, -0.99729045667869021,
    -0.997060070339483, -0.99682029929116567, -0.99657114579055484,
    -0.996312612182778, -0.996044700901252, -0.99576741446765982,
    -0.99548075549192694, -0.99518472667219693, -0.99487933079480562,
    -0.99456457073425542, -0.9942404494531879, -0.99390697000235606,
    -0.9935641355205953, -0.9932119492347945, -0.9928504144598651,
    -0.99247953459871, -0.9920993131421918, -0.99170975366909953,
    -0.99131085984611544, -0.99090263542778, -0.99048508425645709,
    -0.99005821026229712, -0.98962201746320089, -0.989176509964781,
    -0.98872169196032378, -0.98825756773074946, -0.98778414164457218,
    -0.98730141815785843, -0.98680940181418553, -0.98630809724459867,
    -0.98579750916756748, -0.98527764238894122, -0.98474850180190421,
    -0.984210092386929, -0.98366241921173025, -0.98310548743121629,
    -0.98253930228744124, -0.98196386910955524, -0.98137919331375456,
    -0.98078528040323043, -0.98018213596811743, -0.97956976568544052,
    -0.9789481753190622, -0.97831737071962765, -0.97767735782450993,
    -0.97702814265775439, -0.97636973133002114, -0.97570213003852857,
    -0.97502534506699412, -0.97433938278557586, -0.973644249650812,
    -0.97293995220556018, -0.97222649707893627, -0.97150389098625178,
    -0.97077214072895035, -0.970031253194544, -0.96928123535654853,
    -0.96852209427441727, -0.96775383709347551, -0.96697647104485207,
    -0.9661900034454125, -0.9653944416976894, -0.96458979328981276,
    -0.96377606579543984, -0.96295326687368388, -0.96212140426904158,
    -0.96128048581132064, -0.96043051941556579, -0.95957151308198452,
    -0.9587034748958716, -0.95782641302753291, -0.95694033573220882,
    -0.95604525134999641, -0.95514116830577078, -0.95422809510910567,
    -0.95330604035419386, -0.95237501271976588, -0.95143502096900834,
    -0.9504860739494817, -0.94952818059303667, -0.94856134991573027,
    -0.94758559101774109, -0.94660091308328353, -0.94560732538052128,
    -0.94460483726148026, -0.94359345816196039, -0.94257319760144687,
    -0.94154406518302081, -0.9405060705932683, -0.93945922360218992,
    -0.93840353406310806, -0.937339011912575, -0.93626566717027826,
    -0.93518350993894761, -0.93409255040425887, -0.932992798834739,
    -0.93188426558166815, -0.93076696107898371, -0.92964089584318121,
    -0.92850608047321559, -0.92736252565040111, -0.92621024213831138,
    -0.92504924078267758, -0.92387953251128674, -0.92270112833387863,
    -0.9215140393420419, -0.92031827670911059, -0.91911385169005777,
    -0.9179007756213905, -0.9166790599210427, -0.91544871608826783,
    -0.91420975570353069, -0.91296219042839821, -0.91170603200542988,
    -0.91044129225806725, -0.90916798309052238, -0.90788611648766626,
    -0.90659570451491533, -0.90529675931811882, -0.90398929312344334,
    -0.90267331823725883, -0.901348847046022, -0.90001589201616017,
    -0.89867446569395382, -0.89732458070541832, -0.89596624975618522,
    -0.8945994856313827, -0.89322430119551532, -0.89184070939234272,
    -0.89044872324475788, -0.88904835585466457, -0.88763962040285393,
    -0.88622253014888064, -0.88479709843093779, -0.88336333866573158,
    -0.881921264348355, -0.88047088905216075, -0.87901222642863353,
    -0.87754529020726135, -0.8760700941954066, -0.87458665227817611,
    -0.87309497841829009, -0.87159508665595109, -0.87008699110871146,
    -0.8685707059713409, -0.86704624551569265, -0.86551362409056909,
    -0.8639728561215867, -0.8624239561110405, -0.86086693863776731,
    -0.85930181835700847, -0.85772861000027212, -0.85614732837519447,
    -0.85455798836540053, -0.85296060493036363, -0.8513551931052652,
    -0.84974176800085255, -0.84812034480329723, -0.84649093877405213,
    -0.84485356524970712, -0.84320823964184544, -0.84155497743689844,
    -0.83989379419599952, -0.83822470555483808, -0.836547727223512,
    -0.83486287498638, -0.83317016470191319, -0.83146961230254524,
    -0.829761233794523, -0.8280450452577558, -0.82632106284566353,
    -0.82458930278502529, -0.82284978137582643, -0.82110251499110465,
    -0.819347520076797, -0.81758481315158371, -0.81581441080673378,
    -0.81403632970594841, -0.81225058658520388, -0.81045719825259477,
    -0.808656181588175, -0.80684755354379933, -0.80503133114296366,
    -0.80320753148064494, -0.80137617172314024, -0.799537269107905,
    -0.79769084094339116, -0.79583690460888357, -0.79397547755433717,
    -0.79210657730021239, -0.79023022143731, -0.78834642762660634,
    -0.78645521359908577, -0.78455659715557524, -0.78265059616657573,
    -0.78073722857209449, -0.778816512381476, -0.77688846567323244,
    -0.77495310659487393, -0.773010453362737, -0.77106052426181382,
    -0.7691033376455797, -0.7671389119358204, -0.765167265622459,
    -0.76318841726338127, -0.76120238548426178, -0.759209188978388,
    -0.75720884650648457, -0.75520137689653655, -0.75318679904361252,
    -0.75116513190968637, -0.74913639452345937, -0.74710060598018013,
    -0.745057785441466, -0.74300795213512172, -0.74095112535495922,
    -0.73888732446061511, -0.73681656887736979, -0.7347388780959635,
    -0.73265427167241282, -0.73056276922782759, -0.7284643904482252,
    -0.726359155084346, -0.724247082951467, -0.72212819392921535,
    -0.72000250796138165, -0.71787004505573171, -0.71573082528381859,
    -0.71358486878079352, -0.71143219574521643, -0.70927282643886569,
    -0.70710678118654757, -0.70493408037590488, -0.7027547444572253,
    -0.70056879394324834, -0.69837624940897292, -0.696177131491463,
    -0.69397146088965389, -0.69175925836415775, -0.68954054473706683,
    -0.687315340891759, -0.68508366777270036, -0.68284554638524808,
    -0.680600997795453, -0.67835004312986147, -0.67609270357531592,
    -0.673829000378756, -0.67155895484701833, -0.669282588346636,
    -0.66699992230363747, -0.66471097820334479, -0.66241577759017178,
    -0.66011434206742048, -0.65780669329707864, -0.65549285299961535,
    -0.65317284295377676, -0.650846684996381, -0.64851440102211244,
    -0.64617601298331628, -0.64383154288979139, -0.641481012808583,
    -0.63912444486377573, -0.6367618612362842, -0.63439328416364549,
    -0.63201873593980906, -0.629638238914927, -0.62725181549514408,
    -0.62485948814238634, -0.62246127937415, -0.6200572117632891,
    -0.61764730793780387, -0.61523159058062682, -0.61281008242940971,
    -0.61038280627630948, -0.60794978496777363, -0.60551104140432555,
    -0.60306659854034816, -0.600616479383869, -0.59816070699634238,
    -0.59569930449243336, -0.5932322950397998, -0.59075970185887416,
    -0.58828154822264522, -0.58579785745643886, -0.58330865293769829,
    -0.58081395809576453, -0.57831379641165559, -0.57580819141784534,
    -0.5732971666980422, -0.57078074588696726, -0.56825895267013149,
    -0.56573181078361312, -0.56319934401383409, -0.560661576197336,
    -0.5581185312205561, -0.55557023301960218, -0.55301670558002747,
    -0.55045797293660481, -0.54789405917310019, -0.54532498842204646,
    -0.54275078486451589, -0.54017147272989285, -0.53758707629564539,
    -0.53499761988709715, -0.5324031278771979, -0.52980362468629461,
    -0.52719913478190128, -0.524589682678469, -0.52197529293715439,
    -0.51935599016558964, -0.51673179901764987, -0.51410274419322166,
    -0.5114688504379703, -0.508830142543107, -0.50618664534515523,
    -0.50353838372571758, -0.50088538261124071, -0.49822766697278181,
    -0.49556526182577254, -0.49289819222978404, -0.49022648328829116,
    -0.487550160148436, -0.48486924800079106, -0.48218377207912272,
    -0.47949375766015295, -0.47679923006332209, -0.47410021465054997,
    -0.47139673682599764, -0.46868882203582796, -0.46597649576796618,
    -0.46325978355186015, -0.46053871095824, -0.45781330359887717,
    -0.45508358712634384, -0.45234958723377089, -0.44961132965460654,
    -0.44686884016237416, -0.4441221445704292, -0.44137126873171667,
    -0.43861623853852766, -0.43585707992225547, -0.43309381885315196,
    -0.43032648134008261, -0.42755509343028208, -0.42477968120910881,
    -0.42200027079979968, -0.41921688836322391, -0.41642956009763715,
    -0.4136383122384345, -0.41084317105790391, -0.40804416286497869,
    -0.40524131400498986, -0.40243465085941843, -0.39962419984564679,
    -0.39680998741671031, -0.3939920400610481, -0.39117038430225387,
    -0.38834504669882625, -0.38551605384391885, -0.38268343236508978,
    -0.37984720892405116, -0.37700741021641826, -0.37416406297145793,
    -0.37131719395183749, -0.36846682995337232, -0.36561299780477385,
    -0.36275572436739723, -0.35989503653498811, -0.35703096123343,
    -0.35416352542049034, -0.35129275608556709, -0.34841868024943456,
    -0.34554132496398909, -0.34266071731199438, -0.33977688440682685,
    -0.33688985339222005, -0.33399965144200938, -0.33110630575987643,
    -0.3282098435790925, -0.32531029216226293, -0.32240767880106985,
    -0.31950203081601569, -0.31659337555616585, -0.31368174039889152,
    -0.31076715274961147, -0.30784964004153487, -0.30492922973540237,
    -0.30200594931922808, -0.29907982630804048, -0.29615088824362379,
    -0.29321916269425863, -0.29028467725446233, -0.28734745954472951,
    -0.28440753721127188, -0.28146493792575794, -0.27851968938505306,
    -0.27557181931095814, -0.272621355449949, -0.26966832557291509,
    -0.26671275747489837, -0.26375467897483135, -0.26079411791527551,
    -0.257831102162159, -0.25486565960451457, -0.25189781815421697,
    -0.24892760574572015, -0.24595505033579459, -0.24298017990326387,
    -0.2400030224487415, -0.2370236059943672, -0.23404195858354343,
    -0.23105810828067111, -0.22807208317088573, -0.22508391135979283,
    -0.22209362097320351, -0.2191012401568698, -0.21610679707621952,
    -0.21311031991609136, -0.21011183688046961, -0.20711137619221856,
    -0.20410896609281687, -0.2011046348420919, -0.19809841071795356,
    -0.19509032201612825, -0.19208039704989244, -0.18906866414980619,
    -0.18605515166344663, -0.18303988795514095, -0.18002290140569951,
    -0.17700422041214875, -0.17398387338746382, -0.17096188876030122,
    -0.16793829497473117, -0.16491312048996992, -0.16188639378011183,
    -0.15885814333386145, -0.15582839765426523, -0.15279718525844344,
    -0.14976453467732151, -0.14673047445536175, -0.14369503315029447,
    -0.14065823933284921, -0.13762012158648604, -0.13458070850712617,
    -0.13154002870288312, -0.12849811079379317, -0.12545498341154623,
    -0.1224106751992162, -0.11936521481099135, -0.11631863091190475,
    -0.11327095217756435, -0.11022220729388306, -0.10717242495680884,
    -0.10412163387205459, -0.10106986275482782, -0.0980171403295606,
    -0.094963495329638992, -0.091908956497132724, -0.0888535525825246,
    -0.0857973123444399, -0.082740264549375692, -0.079682437971430126,
    -0.076623861392031492, -0.073564563599667426, -0.070504573389613856,
    -0.067443919563664051, -0.064382630929857465, -0.061320736302208578,
    -0.058258264500435752, -0.055195244349689941, -0.052131704680283324,
    -0.049067674327418015, -0.046003182130914623, -0.04293825693494082,
    -0.039872927587739811, -0.036807222941358832, -0.03374117185137758,
    -0.030674803176636626, -0.02760814577896574, -0.024541228522912288,
    -0.021474080275469508, -0.01840672990580482, -0.0153392062849881,
    -0.012271538285719925, -0.00920375478205982, -0.0061358846491544753,
    -0.0030679567629659761, -0.0 };

  int ihi;

  // % Function for spectra estimation by Welch's method
  //  Developed by Luiz A. Baccala, Fl?vio Caduda and Luciano Caldas, all from
  //  Escola Polit?cnica - Poli-USP, with cooperation of Carlos Pagani and Felipe 
  //  Amaral from Escola de Engenharia de S?o Carlos - EESC-USP.
  //
  //  Cross-spectra matrix are estimated by Welch's method with 50% overlap and
  //  the window energy loss are compasated by a factor of 1/sum(Wi.^2) where
  //  Wi are the elements of the window [1]. Then, the spectra becomes:
  //  Sxy = fft(x)*conj(fft(y))/sum(Wi.^2)
  //
  //  Code was tested with a known- spectra signal from a white noise filtered
  //  by a filter. The variance (power) of the signal checks with the integral
  //  of the PSD estimated.
  //
  //  INPUT:
  //  -- signals: matrix of signals to perform the spectra estimatino. Size is
  //  [Samples x number of sensors];
  //  -- fs: samplerate in Hertz;
  //  -- window: data taper desired. Must be a vector. For best performance it
  //  should be a power of 2. For general applications do: window=hanning(1024); 
  //
  //  OUTPUT:
  //  -- CSM: Cross Spectral Matrix: Unilateral (0:fs/2) spectra. Welch's
  //  method is used with 50% overlap. Matrix size: sensors x sensors x
  //  windowsize/2
  //  -- frequencies: vector with all frequencies corresponding to each layer
  //  (3rd layer in depth) of CSM.
  //
  //  LAST REVISION: Aug - 18 - 2016
  //  ADDED 'fs' missing term in line 82, for calibration factor
  //  [1] Trobs,M.; Heinzel,G. "Improved spectrum estimation from digitized
  //  time series on a logarithmic frequency axis"
  //  doi:10.1016/j.measurement.2005.10.010
  for (iy = 0; iy < 1024; iy++) {
    frequencies[iy] = (double)iy * fs / 2048.0;
  }

  // must be even, best if 2^n
  // ORIGINAL;
  iy = signals->size[1];
  number_of_blocks = (int)std::floor(2.0 * (double)iy / 2048.0) - 1;
  memcpy(&data_taper[0], &window[0], sizeof(double) << 11);

  //  Data segmentation into blocks of size block_samples:
  memset(&S[0], 0, sizeof(double) << 10);

  // ORIGINAL
  //  S = zeros(ceil(block_samples/2),number_of_signals.^2);
  for (a = 0; a < number_of_blocks; a++) {
    //  Retrieve current data block
    k = a << 10;
    for (iy = 0; iy < 2048; iy++) {
      Data_Block[iy] = signals->data[iy + k];
    }

    twid_re = signals->data[a << 10];
    for (k = 0; k < 2047; k++) {
      twid_re += signals->data[(k + (a << 10)) + 1];
    }

    twid_re /= 2048.0;
    for (iy = 0; iy < 2048; iy++) {
      Data_Block[iy] = (Data_Block[iy] - twid_re) * data_taper[iy];
    }

    // Taper it
    ix = 0;
    ju = 0;
    iy = 0;
    for (i = 0; i < 2047; i++) {
      b_Data_Block[iy].re = Data_Block[ix];
      b_Data_Block[iy].im = 0.0;
      k = 2048;
      tst = true;
      while (tst) {
        k >>= 1;
        ju ^= k;
        tst = ((ju & k) == 0);
      }

      iy = ju;
      ix++;
    }

    b_Data_Block[iy].re = Data_Block[ix];
    b_Data_Block[iy].im = 0.0;
    for (i = 0; i <= 2047; i += 2) {
      temp_re = b_Data_Block[i + 1].re;
      temp_im = b_Data_Block[i + 1].im;
      b_Data_Block[i + 1].re = b_Data_Block[i].re - b_Data_Block[i + 1].re;
      b_Data_Block[i + 1].im = b_Data_Block[i].im - b_Data_Block[i + 1].im;
      b_Data_Block[i].re += temp_re;
      b_Data_Block[i].im += temp_im;
    }

    iy = 2;
    ix = 4;
    k = 512;
    ju = 2045;
    while (k > 0) {
      for (i = 0; i < ju; i += ix) {
        temp_re = b_Data_Block[i + iy].re;
        temp_im = b_Data_Block[i + iy].im;
        b_Data_Block[i + iy].re = b_Data_Block[i].re - temp_re;
        b_Data_Block[i + iy].im = b_Data_Block[i].im - temp_im;
        b_Data_Block[i].re += temp_re;
        b_Data_Block[i].im += temp_im;
      }

      istart = 1;
      for (j = k; j < 1024; j += k) {
        twid_re = dv5[j];
        twid_im = dv6[j];
        i = istart;
        ihi = istart + ju;
        while (i < ihi) {
          temp_re = twid_re * b_Data_Block[i + iy].re - twid_im * b_Data_Block[i
            + iy].im;
          temp_im = twid_re * b_Data_Block[i + iy].im + twid_im * b_Data_Block[i
            + iy].re;
          b_Data_Block[i + iy].re = b_Data_Block[i].re - temp_re;
          b_Data_Block[i + iy].im = b_Data_Block[i].im - temp_im;
          b_Data_Block[i].re += temp_re;
          b_Data_Block[i].im += temp_im;
          i += ix;
        }

        istart++;
      }

      k /= 2;
      iy = ix;
      ix <<= 1;
      ju -= iy;
    }

    // FFT it,
    //  bilateral DFT
    //  viii
    // ORIGINAL
    //  Data_Block = Data_Block(1:ceil(block_samples/2),:);
    // All spectral combinations:
    // ORIGINAL
    //  P = zeros(ceil(block_samples/2)/2,number_of_signals.^2);
    //  THIS IS FOR WIND TUNNEL EESC-USP BEAMFORMING CODE
    //              P(:,c) = real(Data_Block(:,b).*conj(Data_Block(:,aa)));
    //  P(:,c) = Data_Block(:,b).*conj(Data_Block(:,aa));
    //  IS FOR FAN RIG BEAMFORMING CODE
    //  P(:,c) = Data_Block(:,aa).*conj(Data_Block(:,b)); % THIS IS THE ORIGINAL LINE 
    //  Sum the spectrums up ...
    for (i = 0; i < 1024; i++) {
      S[i] += b_Data_Block[i].re * b_Data_Block[i].re - b_Data_Block[i].im *
        -b_Data_Block[i].im;
    }
  }

  for (iy = 0; iy < 1024; iy++) {
    S[iy] *= 2.0;
  }

  memcpy(&data_taper[0], &window[0], sizeof(double) << 11);

#pragma omp parallel for \
 num_threads(omp_get_max_threads()) \
 private(c_k)

  for (b_k = 1; b_k < 2049; b_k++) {
    c_k = b_k;
    Data_Block[c_k - 1] = data_taper[c_k - 1] * data_taper[c_k - 1];
  }

  twid_re = Data_Block[0];
  for (k = 0; k < 2047; k++) {
    twid_re += Data_Block[k + 1];
  }

  twid_re = twid_re * fs * (double)number_of_blocks;

  //  Average them out
  //  for a = 1:sensors
  for (iy = 0; iy < 1024; iy++) {
    CSM[iy] = S[iy] / twid_re;
  }

  //  end
  //  clear S
  CSM[0] = (CSM[0] + CSM[0]) - CSM[0];
}

//
// CLASSIFYSSVEP - FINAL VERSION FOR MATLAB CODER
//  INPUT VARS:
//  X - input array (any size)
//  start - where to start from in 'X'
//  Fs - signal sampling frequency
// Arguments    : const double X[1000]
// Return Type  : double
//
double classifySSVEP(const double X[1000])
{
  double CLASS;
  emxArray_real_T *fch;
  emxArray_real_T *b_X;
  double P[224];
  int i;
  int ixstart;
  double M[4];
  int ix;
  double maxval[7];
  double mtmp;
  int b_i;
  int itmp;
  int b_ix;
  boolean_T exitg1;
  double dv0[56];
  boolean_T exitg2;
  boolean_T exitg3;
  emxArray_real_T *b;
  emxArray_int32_T *r0;
  emxInit_real_T(&fch, 2);

  //  range - range of window sizes to view
  //  1-4 s at 60pt intervals
  emxInit_real_T1(&b_X, 1);
  for (i = 0; i < 4; i++) {
    ixstart = 250 * i + 250;
    ix = b_X->size[0];
    b_X->size[0] = ixstart;
    emxEnsureCapacity((emxArray__common *)b_X, ix, (int)sizeof(double));
    for (ix = 0; ix < ixstart; ix++) {
      b_X->data[ix] = X[ix];
    }

    ssvepcfilt(b_X, fch);

    // %%Feature Extraction: (per channel)
    //      fprintf('Current index = [%d to %d]\r\n',start, fin);
    //      fprintf('length = %d\r\n',range(i));
    fESSVEP2(fch, dv0);
    for (ix = 0; ix < 56; ix++) {
      P[i + (ix << 2)] = dv0[ix];
    }
  }

  emxFree_real_T(&b_X);
  emxFree_real_T(&fch);
  for (i = 0; i < 4; i++) {
    for (b_i = 0; b_i < 7; b_i++) {
      b_ix = (b_i << 2) + 4;
      ix = (b_i << 2) + 1;
      mtmp = P[(b_ix - 4) % 4 + ((((b_ix - 4) / 4 + i * 7) + 28) << 2)];
      if (rtIsNaN(P[(b_ix - 4) % 4 + ((((b_ix - 4) / 4 + i * 7) + 28) << 2)])) {
        ixstart = ix;
        exitg3 = false;
        while ((!exitg3) && (ixstart + 1 <= b_ix)) {
          ix = ixstart + 1;
          if (!rtIsNaN(P[ixstart % 4 + (((ixstart / 4 + i * 7) + 28) << 2)])) {
            mtmp = P[ixstart % 4 + (((ixstart / 4 + i * 7) + 28) << 2)];
            exitg3 = true;
          } else {
            ixstart++;
          }
        }
      }

      if (ix < b_ix) {
        while (ix + 1 <= b_ix) {
          if (P[ix % 4 + (((ix / 4 + i * 7) + 28) << 2)] > mtmp) {
            mtmp = P[ix % 4 + (((ix / 4 + i * 7) + 28) << 2)];
          }

          ix++;
        }
      }

      maxval[b_i] = mtmp;
    }

    ixstart = 1;
    mtmp = maxval[0];
    if (rtIsNaN(maxval[0])) {
      b_ix = 2;
      exitg2 = false;
      while ((!exitg2) && (b_ix < 8)) {
        ixstart = b_ix;
        if (!rtIsNaN(maxval[b_ix - 1])) {
          mtmp = maxval[b_ix - 1];
          exitg2 = true;
        } else {
          b_ix++;
        }
      }
    }

    if (ixstart < 7) {
      while (ixstart + 1 < 8) {
        if (maxval[ixstart] > mtmp) {
          mtmp = maxval[ixstart];
        }

        ixstart++;
      }
    }

    M[i] = mtmp;
  }

  ixstart = 1;
  mtmp = M[0];
  itmp = 1;
  if (rtIsNaN(M[0])) {
    b_ix = 2;
    exitg1 = false;
    while ((!exitg1) && (b_ix < 5)) {
      ixstart = b_ix;
      if (!rtIsNaN(M[b_ix - 1])) {
        mtmp = M[b_ix - 1];
        itmp = b_ix;
        exitg1 = true;
      } else {
        b_ix++;
      }
    }
  }

  if (ixstart < 4) {
    while (ixstart + 1 < 5) {
      if (M[ixstart] > mtmp) {
        mtmp = M[ixstart];
        itmp = ixstart + 1;
      }

      ixstart++;
    }
  }

  b_ix = 0;
  for (i = 0; i < 4; i++) {
    if (itmp != 1 + i) {
      b_ix++;
    }
  }

  emxInit_real_T(&b, 2);
  ix = b->size[0] * b->size[1];
  b->size[0] = 1;
  b->size[1] = b_ix;
  emxEnsureCapacity((emxArray__common *)b, ix, (int)sizeof(double));
  for (ix = 0; ix < b_ix; ix++) {
    b->data[ix] = 0.0;
  }

  b_ix = 0;
  for (i = 0; i < 4; i++) {
    if (itmp != 1 + i) {
      b_ix++;
    }
  }

  i = 0;
  emxInit_int32_T(&r0, 2);
  while (i <= b_ix - 1) {
    ixstart = 0;
    for (b_i = 0; b_i < 4; b_i++) {
      if (itmp != 1 + b_i) {
        ixstart++;
      }
    }

    ix = r0->size[0] * r0->size[1];
    r0->size[0] = 1;
    r0->size[1] = ixstart;
    emxEnsureCapacity((emxArray__common *)r0, ix, (int)sizeof(int));
    ixstart = 0;
    for (b_i = 0; b_i < 4; b_i++) {
      if (itmp != 1 + b_i) {
        r0->data[ixstart] = b_i + 1;
        ixstart++;
      }
    }

    b->data[i] = (M[r0->data[r0->size[0] * i] - 1] > mtmp / 3.0);
    i++;
  }

  emxFree_int32_T(&r0);

  //  CLASS = [];
  //  CLASS = input('Approve/continue?\n');
  //  if isempty(CLASS)
  if (b->size[1] == 0) {
    mtmp = 0.0;
  } else {
    mtmp = b->data[0];
    for (ixstart = 2; ixstart <= b->size[1]; ixstart++) {
      mtmp += b->data[ixstart - 1];
    }
  }

  emxFree_real_T(&b);
  if (mtmp == 0.0) {
    CLASS = itmp;
  } else {
    CLASS = 0.0;
  }

  //  end
  //  for i = 1:size(F,1)
  //      FS(1+size(F,2)*(i-1):size(F,2)*(i)) = F(i,:);
  //  end
  return CLASS;
}

//
// Arguments    : void
// Return Type  : void
//
void classifySSVEP_initialize()
{
  rt_InitInfAndNaN(8U);
//  omp_init_nest_lock(&emlrtNestLockGlobal);
}

//
// Arguments    : void
// Return Type  : void
//
void classifySSVEP_terminate()
{
//  omp_destroy_nest_lock(&emlrtNestLockGlobal);
}

//
// File trailer for classifySSVEP.cpp
//
// [EOF]
//
